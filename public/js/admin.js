/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./resources/js/admin.js":
/*!*******************************!*\
  !*** ./resources/js/admin.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var trumbowyg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! trumbowyg */ \"./node_modules/trumbowyg/dist/trumbowyg.js\");\n/* harmony import */ var trumbowyg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(trumbowyg__WEBPACK_IMPORTED_MODULE_0__);\n\n$('.trumbowyg-form').trumbowyg({\n  svgPath: '/js/ui/icons.svg'\n}); // Toggle the side navigation\n\n$('#sidenavToggler').click(function (e) {\n  e.preventDefault();\n  $('body').toggleClass('sidenav-toggled');\n}); // Configure tooltips for collapsed side navigation\n\n$('.navbar-sidenav [data-toggle=\"tooltip\"]').tooltip({\n  template: '<div class=\"tooltip navbar-sidenav-tooltip\" role=\"tooltip\"><div class=\"arrow\"></div><div class=\"tooltip-inner\"></div></div>'\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9yZXNvdXJjZXMvanMvYWRtaW4uanMuanMiLCJtYXBwaW5ncyI6Ijs7O0FBQUE7QUFFQUEsQ0FBQyxDQUFDLGlCQUFELENBQUQsQ0FBcUJDLFNBQXJCLENBQStCO0FBQzdCQyxFQUFBQSxPQUFPLEVBQUU7QUFEb0IsQ0FBL0IsR0FJQTs7QUFDQUYsQ0FBQyxDQUFDLGlCQUFELENBQUQsQ0FBcUJHLEtBQXJCLENBQTJCLFVBQVVDLENBQVYsRUFBYTtBQUN0Q0EsRUFBQUEsQ0FBQyxDQUFDQyxjQUFGO0FBQ0FMLEVBQUFBLENBQUMsQ0FBQyxNQUFELENBQUQsQ0FBVU0sV0FBVixDQUFzQixpQkFBdEI7QUFDRCxDQUhELEdBS0E7O0FBQ0FOLENBQUMsQ0FBQyx5Q0FBRCxDQUFELENBQTZDTyxPQUE3QyxDQUFxRDtBQUNuREMsRUFBQUEsUUFBUSxFQUFFO0FBRHlDLENBQXJEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2FkbWluLmpzPzkyNmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICd0cnVtYm93eWcnXHJcblxyXG4kKCcudHJ1bWJvd3lnLWZvcm0nKS50cnVtYm93eWcoe1xyXG4gIHN2Z1BhdGg6ICcvanMvdWkvaWNvbnMuc3ZnJ1xyXG59KVxyXG5cclxuLy8gVG9nZ2xlIHRoZSBzaWRlIG5hdmlnYXRpb25cclxuJCgnI3NpZGVuYXZUb2dnbGVyJykuY2xpY2soZnVuY3Rpb24gKGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KClcclxuICAkKCdib2R5JykudG9nZ2xlQ2xhc3MoJ3NpZGVuYXYtdG9nZ2xlZCcpXHJcbn0pXHJcblxyXG4vLyBDb25maWd1cmUgdG9vbHRpcHMgZm9yIGNvbGxhcHNlZCBzaWRlIG5hdmlnYXRpb25cclxuJCgnLm5hdmJhci1zaWRlbmF2IFtkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKHtcclxuICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ0b29sdGlwIG5hdmJhci1zaWRlbmF2LXRvb2x0aXBcIiByb2xlPVwidG9vbHRpcFwiPjxkaXYgY2xhc3M9XCJhcnJvd1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJ0b29sdGlwLWlubmVyXCI+PC9kaXY+PC9kaXY+J1xyXG59KVxyXG4iXSwibmFtZXMiOlsiJCIsInRydW1ib3d5ZyIsInN2Z1BhdGgiLCJjbGljayIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRvZ2dsZUNsYXNzIiwidG9vbHRpcCIsInRlbXBsYXRlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./resources/js/admin.js\n");

/***/ }),

/***/ "./node_modules/trumbowyg/dist/trumbowyg.js":
/*!**************************************************!*\
  !*** ./node_modules/trumbowyg/dist/trumbowyg.js ***!
  \**************************************************/
/***/ (() => {

eval("/**\n * Trumbowyg v2.25.1 - A lightweight WYSIWYG editor\n * Trumbowyg core file\n * ------------------------\n * @link http://alex-d.github.io/Trumbowyg\n * @license MIT\n * @author Alexandre Demode (Alex-D)\n *         Twitter : @AlexandreDemode\n *         Website : alex-d.fr\n */\n\njQuery.trumbowyg = {\n    langs: {\n        en: {\n            viewHTML: 'View HTML',\n\n            undo: 'Undo',\n            redo: 'Redo',\n\n            formatting: 'Formatting',\n            p: 'Paragraph',\n            blockquote: 'Quote',\n            code: 'Code',\n            header: 'Header',\n\n            bold: 'Bold',\n            italic: 'Italic',\n            strikethrough: 'Strikethrough',\n            underline: 'Underline',\n\n            strong: 'Strong',\n            em: 'Emphasis',\n            del: 'Deleted',\n\n            superscript: 'Superscript',\n            subscript: 'Subscript',\n\n            unorderedList: 'Unordered list',\n            orderedList: 'Ordered list',\n\n            insertImage: 'Insert Image',\n            link: 'Link',\n            createLink: 'Insert link',\n            unlink: 'Remove link',\n\n            justifyLeft: 'Align Left',\n            justifyCenter: 'Align Center',\n            justifyRight: 'Align Right',\n            justifyFull: 'Align Justify',\n\n            horizontalRule: 'Insert horizontal rule',\n            removeformat: 'Remove format',\n\n            fullscreen: 'Fullscreen',\n\n            close: 'Close',\n\n            submit: 'Confirm',\n            reset: 'Cancel',\n\n            required: 'Required',\n            description: 'Description',\n            title: 'Title',\n            text: 'Text',\n            target: 'Target',\n            width: 'Width'\n        }\n    },\n\n    // Plugins\n    plugins: {},\n\n    // SVG Path globally\n    svgPath: null,\n    svgAbsoluteUseHref: false,\n\n    hideButtonTexts: null\n};\n\n// Makes default options read-only\nObject.defineProperty(jQuery.trumbowyg, 'defaultOptions', {\n    value: {\n        lang: 'en',\n\n        fixedBtnPane: false,\n        fixedFullWidth: false,\n        autogrow: false,\n        autogrowOnEnter: false,\n        imageWidthModalEdit: false,\n        hideButtonTexts: null,\n\n        prefix: 'trumbowyg-',\n        tagClasses: {},\n        semantic: true,\n        semanticKeepAttributes: false,\n        resetCss: false,\n        removeformatPasted: false,\n        tabToIndent: false,\n        tagsToRemove: [],\n        tagsToKeep: ['hr', 'img', 'embed', 'iframe', 'input'],\n        btns: [\n            ['viewHTML'],\n            ['undo', 'redo'], // Only supported in Blink browsers\n            ['formatting'],\n            ['strong', 'em', 'del'],\n            ['superscript', 'subscript'],\n            ['link'],\n            ['insertImage'],\n            ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],\n            ['unorderedList', 'orderedList'],\n            ['horizontalRule'],\n            ['removeformat'],\n            ['fullscreen']\n        ],\n        // For custom button definitions\n        btnsDef: {},\n        changeActiveDropdownIcon: false,\n\n        inlineElementsSelector: 'a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u',\n\n        pasteHandlers: [],\n\n        // imgDblClickHandler: default is defined in constructor\n\n        plugins: {},\n\n        urlProtocol: false,\n        minimalLinks: false,\n        defaultLinkTarget: undefined,\n\n        svgPath: null\n    },\n    writable: false,\n    enumerable: true,\n    configurable: false\n});\n\n(function (navigator, window, document, $) {\n    'use strict';\n\n    var CONFIRM_EVENT = 'tbwconfirm',\n        CANCEL_EVENT = 'tbwcancel';\n\n    $.fn.trumbowyg = function (options, params) {\n        var trumbowygDataName = 'trumbowyg';\n        if (options === Object(options) || !options) {\n            return this.each(function () {\n                if (!$(this).data(trumbowygDataName)) {\n                    $(this).data(trumbowygDataName, new Trumbowyg(this, options));\n                }\n            });\n        }\n        if (this.length === 1) {\n            try {\n                var t = $(this).data(trumbowygDataName);\n                switch (options) {\n                    // Exec command\n                    case 'execCmd':\n                        return t.execCmd(params.cmd, params.param, params.forceCss, params.skipTrumbowyg);\n\n                    // Modal box\n                    case 'openModal':\n                        return t.openModal(params.title, params.content);\n                    case 'closeModal':\n                        return t.closeModal();\n                    case 'openModalInsert':\n                        return t.openModalInsert(params.title, params.fields, params.callback);\n\n                    // Range\n                    case 'saveRange':\n                        return t.saveRange();\n                    case 'getRange':\n                        return t.range;\n                    case 'getRangeText':\n                        return t.getRangeText();\n                    case 'restoreRange':\n                        return t.restoreRange();\n\n                    // Enable/disable\n                    case 'enable':\n                        return t.setDisabled(false);\n                    case 'disable':\n                        return t.setDisabled(true);\n\n                    // Toggle\n                    case 'toggle':\n                        return t.toggle();\n\n                    // Destroy\n                    case 'destroy':\n                        return t.destroy();\n\n                    // Empty\n                    case 'empty':\n                        return t.empty();\n\n                    // HTML\n                    case 'html':\n                        return t.html(params);\n                }\n            } catch (c) {\n            }\n        }\n\n        return false;\n    };\n\n    // @param: editorElem is the DOM element\n    var Trumbowyg = function (editorElem, options) {\n        var t = this,\n            trumbowygIconsId = 'trumbowyg-icons',\n            $trumbowyg = $.trumbowyg;\n\n        // Get the document of the element. It use to makes the plugin\n        // compatible on iframes.\n        t.doc = editorElem.ownerDocument || document;\n\n        // jQuery object of the editor\n        t.$ta = $(editorElem); // $ta : Textarea\n        t.$c = $(editorElem); // $c : creator\n\n        options = options || {};\n\n        // Localization management\n        if (options.lang != null || $trumbowyg.langs[options.lang] != null) {\n            t.lang = $.extend(true, {}, $trumbowyg.langs.en, $trumbowyg.langs[options.lang]);\n        } else {\n            t.lang = $trumbowyg.langs.en;\n        }\n\n        t.hideButtonTexts = $trumbowyg.hideButtonTexts != null ? $trumbowyg.hideButtonTexts : options.hideButtonTexts;\n\n        // SVG path\n        var svgPathOption = $trumbowyg.svgPath != null ? $trumbowyg.svgPath : options.svgPath;\n        t.hasSvg = svgPathOption !== false;\n\n        if (svgPathOption !== false && ($trumbowyg.svgAbsoluteUseHref || $('#' + trumbowygIconsId, t.doc).length === 0)) {\n            if (svgPathOption == null) {\n                // Hack to get svgPathOption based on trumbowyg.js path\n                var $scriptElements = $('script[src]');\n                $scriptElements.each(function (i, scriptElement) {\n                    var source = scriptElement.src;\n                    var matches = source.match('trumbowyg(\\.min)?\\.js');\n                    if (matches != null) {\n                        svgPathOption = source.substring(0, source.indexOf(matches[0])) + 'ui/icons.svg';\n                    }\n                });\n            }\n\n            // Do not merge with previous if block: svgPathOption can be redefined in it.\n            // Here we are checking that we find a match\n            if (svgPathOption == null) {\n                console.warn('You must define svgPath: https://goo.gl/CfTY9U'); // jshint ignore:line\n            } else if (!$trumbowyg.svgAbsoluteUseHref) {\n                var div = t.doc.createElement('div');\n                div.id = trumbowygIconsId;\n                t.doc.body.insertBefore(div, t.doc.body.childNodes[0]);\n                $.ajax({\n                    async: true,\n                    type: 'GET',\n                    contentType: 'application/x-www-form-urlencoded; charset=UTF-8',\n                    dataType: 'xml',\n                    crossDomain: true,\n                    url: svgPathOption,\n                    data: null,\n                    beforeSend: null,\n                    complete: null,\n                    success: function (data) {\n                        div.innerHTML = new XMLSerializer().serializeToString(data.documentElement);\n                    }\n                });\n            }\n        }\n\n        var baseHref = !!t.doc.querySelector('base') ? window.location.href.split(/[?#]/)[0] : '';\n        t.svgPath = $trumbowyg.svgAbsoluteUseHref ? svgPathOption : baseHref;\n\n\n        /**\n         * When the button is associated to a empty object\n         * fn and title attributes are defined from the button key value\n         *\n         * For example\n         *      foo: {}\n         * is equivalent to :\n         *      foo: {\n         *          fn: 'foo',\n         *          title: this.lang.foo\n         *      }\n         */\n        var h = t.lang.header, // Header translation\n            isBlinkFunction = function () {\n                return (window.chrome || (window.Intl && Intl.v8BreakIterator)) && 'CSS' in window;\n            };\n        t.btnsDef = {\n            viewHTML: {\n                fn: 'toggle',\n                class: 'trumbowyg-not-disable',\n            },\n\n            undo: {\n                isSupported: isBlinkFunction,\n                key: 'Z'\n            },\n            redo: {\n                isSupported: isBlinkFunction,\n                key: 'Y'\n            },\n\n            p: {\n                fn: 'formatBlock'\n            },\n            blockquote: {\n                fn: 'formatBlock'\n            },\n            h1: {\n                fn: 'formatBlock',\n                title: h + ' 1'\n            },\n            h2: {\n                fn: 'formatBlock',\n                title: h + ' 2'\n            },\n            h3: {\n                fn: 'formatBlock',\n                title: h + ' 3'\n            },\n            h4: {\n                fn: 'formatBlock',\n                title: h + ' 4'\n            },\n            h5: {\n                fn: 'formatBlock',\n                title: h + ' 5'\n            },\n            h6: {\n                fn: 'formatBlock',\n                title: h + ' 6'\n            },\n            subscript: {\n                tag: 'sub'\n            },\n            superscript: {\n                tag: 'sup'\n            },\n\n            bold: {\n                key: 'B',\n                tag: 'b'\n            },\n            italic: {\n                key: 'I',\n                tag: 'i'\n            },\n            underline: {\n                tag: 'u'\n            },\n            strikethrough: {\n                tag: 'strike'\n            },\n\n            strong: {\n                fn: 'bold',\n                key: 'B'\n            },\n            em: {\n                fn: 'italic',\n                key: 'I'\n            },\n            del: {\n                fn: 'strikethrough'\n            },\n\n            createLink: {\n                key: 'K',\n                tag: 'a'\n            },\n            unlink: {},\n\n            insertImage: {},\n\n            justifyLeft: {\n                tag: 'left',\n                forceCss: true\n            },\n            justifyCenter: {\n                tag: 'center',\n                forceCss: true\n            },\n            justifyRight: {\n                tag: 'right',\n                forceCss: true\n            },\n            justifyFull: {\n                tag: 'justify',\n                forceCss: true\n            },\n\n            unorderedList: {\n                fn: 'insertUnorderedList',\n                tag: 'ul'\n            },\n            orderedList: {\n                fn: 'insertOrderedList',\n                tag: 'ol'\n            },\n\n            horizontalRule: {\n                fn: 'insertHorizontalRule'\n            },\n\n            removeformat: {},\n\n            fullscreen: {\n                class: 'trumbowyg-not-disable'\n            },\n            close: {\n                fn: 'destroy',\n                class: 'trumbowyg-not-disable'\n            },\n\n            // Dropdowns\n            formatting: {\n                dropdown: ['p', 'blockquote', 'h1', 'h2', 'h3', 'h4'],\n                ico: 'p'\n            },\n            link: {\n                dropdown: ['createLink', 'unlink']\n            }\n        };\n\n        // Default Options\n        t.o = $.extend(true, {}, $trumbowyg.defaultOptions, options);\n        if (!t.o.hasOwnProperty('imgDblClickHandler')) {\n            t.o.imgDblClickHandler = t.getDefaultImgDblClickHandler();\n        }\n\n        t.urlPrefix = t.setupUrlPrefix();\n\n        t.disabled = t.o.disabled || (editorElem.nodeName === 'TEXTAREA' && editorElem.disabled);\n\n        if (options.btns) {\n            t.o.btns = options.btns;\n        } else if (!t.o.semantic) {\n            t.o.btns[3] = ['bold', 'italic', 'underline', 'strikethrough'];\n        }\n\n        $.each(t.o.btnsDef, function (btnName, btnDef) {\n            t.addBtnDef(btnName, btnDef);\n        });\n\n        // put this here in the event it would be merged in with options\n        t.eventNamespace = 'trumbowyg-event';\n\n        // Keyboard shortcuts are load in this array\n        t.keys = [];\n\n        // Tag to button dynamically hydrated\n        t.tagToButton = {};\n        t.tagHandlers = [];\n\n        // Admit multiple paste handlers\n        t.pasteHandlers = [].concat(t.o.pasteHandlers);\n\n        // Check if browser is IE\n        t.isIE = navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') !== -1;\n\n        // Check if we are on macOs\n        t.isMac = navigator.platform.toUpperCase().indexOf('MAC') !== -1;\n\n        t.init();\n    };\n\n    Trumbowyg.prototype = {\n        DEFAULT_SEMANTIC_MAP: {\n            'b': 'strong',\n            'i': 'em',\n            's': 'del',\n            'strike': 'del',\n            'div': 'p'\n        },\n\n        init: function () {\n            var t = this;\n            t.height = t.$ta.height();\n\n            t.initPlugins();\n\n            try {\n                // Disable image resize, try-catch for old IE\n                t.doc.execCommand('enableObjectResizing', false, false);\n                t.doc.execCommand('defaultParagraphSeparator', false, 'p');\n            } catch (e) {\n            }\n\n            t.buildEditor();\n            t.buildBtnPane();\n\n            t.fixedBtnPaneEvents();\n\n            t.buildOverlay();\n\n            setTimeout(function () {\n                if (t.disabled) {\n                    t.setDisabled(true);\n                }\n                t.$c.trigger('tbwinit');\n            });\n        },\n\n        addBtnDef: function (btnName, btnDef) {\n            this.btnsDef[btnName] = $.extend(btnDef, this.btnsDef[btnName] || {});\n        },\n\n        setupUrlPrefix: function () {\n            var protocol = this.o.urlProtocol;\n            if (!protocol) {\n                return;\n            }\n\n            if (typeof (protocol) !== 'string') {\n                return 'https://';\n            }\n            return protocol.replace('://', '') + '://';\n        },\n\n        buildEditor: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                html = '';\n\n            t.$box = $('<div/>', {\n                class: prefix + 'box ' + prefix + 'editor-visible ' + prefix + t.o.lang + ' trumbowyg'\n            });\n\n            // $ta = Textarea\n            // $ed = Editor\n            t.isTextarea = t.$ta.is('textarea');\n            if (t.isTextarea) {\n                html = t.$ta.val();\n                t.$ed = $('<div/>');\n                t.$box\n                    .insertAfter(t.$ta)\n                    .append(t.$ed, t.$ta);\n            } else {\n                t.$ed = t.$ta;\n                html = t.$ed.html();\n\n                t.$ta = $('<textarea/>', {\n                    name: t.$ta.attr('id'),\n                    height: t.height\n                }).val(html);\n\n                t.$box\n                    .insertAfter(t.$ed)\n                    .append(t.$ta, t.$ed);\n                t.syncCode();\n            }\n\n            t.$ta\n                .addClass(prefix + 'textarea')\n                .attr('tabindex', -1)\n            ;\n\n            t.$ed\n                .addClass(prefix + 'editor')\n                .attr({\n                    contenteditable: true,\n                    dir: t.lang._dir || 'ltr'\n                })\n                .html(html)\n            ;\n\n            if (t.o.tabindex) {\n                t.$ed.attr('tabindex', t.o.tabindex);\n            }\n\n            if (t.$c.is('[placeholder]')) {\n                t.$ed.attr('placeholder', t.$c.attr('placeholder'));\n            }\n\n            if (t.$c.is('[spellcheck]')) {\n                t.$ed.attr('spellcheck', t.$c.attr('spellcheck'));\n            }\n\n            if (t.o.resetCss) {\n                t.$ed.addClass(prefix + 'reset-css');\n            }\n\n            if (!t.o.autogrow) {\n                t.$ta.add(t.$ed).css({\n                    height: t.height\n                });\n            }\n\n            t.semanticCode();\n\n            if (t.o.autogrowOnEnter) {\n                t.$ed.addClass(prefix + 'autogrow-on-enter');\n            }\n\n            var ctrl = false,\n                composition = false,\n                debounceButtonPaneStatus;\n\n            t.$ed\n                .on('dblclick', 'img', t.o.imgDblClickHandler)\n                .on('keydown', function (e) {\n                    // append flags to differentiate Chrome spans\n                    var keyCode = e.which;\n                    if (keyCode === 8 || keyCode === 13 || keyCode === 46) {\n                        t.toggleSpan(true);\n                    }\n                    if ((e.ctrlKey || e.metaKey) && !e.altKey) {\n                        ctrl = true;\n                        var key = t.keys[String.fromCharCode(e.which).toUpperCase()];\n\n                        try {\n                            t.execCmd(key.fn, key.param);\n                            return false;\n                        } catch (c) {\n                        }\n                    } else {\n                        if (t.o.tabToIndent && e.key === 'Tab') {\n                            try {\n                                if (e.shiftKey) {\n                                    t.execCmd('outdent', true, null);\n                                } else {\n                                    t.execCmd('indent', true, null);\n                                }\n                                return false;\n                            } catch (c) {\n                            }\n                        }\n                    }\n                })\n                .on('compositionstart compositionupdate', function () {\n                    composition = true;\n                })\n                .on('keyup compositionend', function (e) {\n                    if (e.type === 'compositionend') {\n                        composition = false;\n                    } else if (composition) {\n                        return;\n                    }\n\n                    var keyCode = e.which;\n\n                    if (keyCode >= 37 && keyCode <= 40) {\n                        return;\n                    }\n\n                    // remove Chrome generated span tags\n                    if (keyCode === 8 || keyCode === 13 || keyCode === 46) {\n                        t.toggleSpan();\n                    }\n\n                    if ((e.ctrlKey || e.metaKey) && (keyCode === 89 || keyCode === 90)) {\n                        t.semanticCode(false, true);\n                        t.$c.trigger('tbwchange');\n                    } else if (!ctrl && keyCode !== 17) {\n                        var compositionEndIE = t.isIE ? e.type === 'compositionend' : true;\n                        t.semanticCode(false, compositionEndIE && keyCode === 13);\n                        t.$c.trigger('tbwchange');\n                    } else if (typeof e.which === 'undefined') {\n                        t.semanticCode(false, false, true);\n                    }\n\n                    setTimeout(function () {\n                        ctrl = false;\n                    }, 50);\n                })\n                .on('mouseup keydown keyup', function (e) {\n                    if ((!e.ctrlKey && !e.metaKey) || e.altKey) {\n                        setTimeout(function () { // \"hold on\" to the ctrl key for 50ms\n                            ctrl = false;\n                        }, 50);\n                    }\n                    clearTimeout(debounceButtonPaneStatus);\n                    debounceButtonPaneStatus = setTimeout(function () {\n                        t.updateButtonPaneStatus();\n                    }, 50);\n                })\n                .on('focus blur', function (e) {\n                    if (e.type === 'blur') {\n                        t.clearButtonPaneStatus();\n                    }\n                    t.$c.trigger('tbw' + e.type);\n                    if (t.o.autogrowOnEnter) {\n                        if (t.autogrowOnEnterDontClose) {\n                            return;\n                        }\n                        if (e.type === 'focus') {\n                            t.autogrowOnEnterWasFocused = true;\n                            t.autogrowEditorOnEnter();\n                        } else if (!t.o.autogrow) {\n                            t.$ed.css({height: t.$ed.css('min-height')});\n                            t.$c.trigger('tbwresize');\n                        }\n                    }\n                })\n                .on('keyup focus', function () {\n                  if (!t.$ta.val().match(/<.*>/) && !t.$ed.html().match(/<.*>/)) {\n                        setTimeout(function () {\n                            var block = t.isIE ? '<p>' : 'p';\n                            t.doc.execCommand('formatBlock', false, block);\n                            t.syncCode();\n                        }, 0);\n                    }\n                })\n                .on('cut drop', function () {\n                    setTimeout(function () {\n                        t.semanticCode(false, true);\n                        t.$c.trigger('tbwchange');\n                    }, 0);\n                })\n                .on('paste', function (e) {\n                    if (t.o.removeformatPasted) {\n                        e.preventDefault();\n\n                        if (window.getSelection && window.getSelection().deleteFromDocument) {\n                            window.getSelection().deleteFromDocument();\n                        }\n\n                        try {\n                            // IE\n                            var text = window.clipboardData.getData('Text');\n\n                            try {\n                                // <= IE10\n                                t.doc.selection.createRange().pasteHTML(text);\n                            } catch (c) {\n                                // IE 11\n                                t.doc.getSelection().getRangeAt(0).insertNode(t.doc.createTextNode(text));\n                            }\n                            t.$c.trigger('tbwchange', e);\n                        } catch (d) {\n                            // Not IE\n                            t.execCmd('insertText', (e.originalEvent || e).clipboardData.getData('text/plain'));\n                        }\n                    }\n\n                    // Call pasteHandlers\n                    $.each(t.pasteHandlers, function (i, pasteHandler) {\n                        pasteHandler(e);\n                    });\n\n                    setTimeout(function () {\n                        t.semanticCode(false, true);\n                        t.$c.trigger('tbwpaste', e);\n                        t.$c.trigger('tbwchange');\n                    }, 0);\n                });\n\n            t.$ta\n                .on('keyup', function () {\n                    t.$c.trigger('tbwchange');\n                })\n                .on('paste', function () {\n                    setTimeout(function () {\n                        t.$c.trigger('tbwchange');\n                    }, 0);\n                });\n\n            $(t.doc.body).on('keydown.' + t.eventNamespace, function (e) {\n                if (e.which === 27 && $('.' + prefix + 'modal-box').length >= 1) {\n                    t.closeModal();\n                    return false;\n                }\n            });\n        },\n\n        //autogrow when entering logic\n        autogrowEditorOnEnter: function () {\n            var t = this;\n            t.$ed.removeClass('autogrow-on-enter');\n            var oldHeight = t.$ed[0].clientHeight;\n            t.$ed.height('auto');\n            var totalHeight = t.$ed[0].scrollHeight;\n            t.$ed.addClass('autogrow-on-enter');\n            if (oldHeight !== totalHeight) {\n                t.$ed.height(oldHeight);\n                setTimeout(function () {\n                    t.$ed.css({height: totalHeight});\n                    t.$c.trigger('tbwresize');\n                }, 0);\n            }\n        },\n\n\n        // Build button pane, use o.btns option\n        buildBtnPane: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            var $btnPane = t.$btnPane = $('<div/>', {\n                class: prefix + 'button-pane'\n            });\n\n            $.each(t.o.btns, function (i, btnGrp) {\n                if (!$.isArray(btnGrp)) {\n                    btnGrp = [btnGrp];\n                }\n\n                var $btnGroup = $('<div/>', {\n                    class: prefix + 'button-group ' + ((btnGrp.indexOf('fullscreen') >= 0) ? prefix + 'right' : '')\n                });\n                $.each(btnGrp, function (i, btn) {\n                    try { // Prevent buildBtn error\n                        if (t.isSupportedBtn(btn)) { // It's a supported button\n                            $btnGroup.append(t.buildBtn(btn));\n                        }\n                    } catch (c) {\n                    }\n                });\n\n                if ($btnGroup.html().trim().length > 0) {\n                    $btnPane.append($btnGroup);\n                }\n            });\n\n            t.$box.prepend($btnPane);\n        },\n\n\n        // Build a button and his action\n        buildBtn: function (btnName) { // btnName is name of the button\n            var t = this,\n                prefix = t.o.prefix,\n                btn = t.btnsDef[btnName],\n                isDropdown = btn.dropdown,\n                hasIcon = btn.hasIcon != null ? btn.hasIcon : true,\n                textDef = t.lang[btnName] || btnName,\n\n                $btn = $('<button/>', {\n                    type: 'button',\n                    class: prefix + btnName + '-button ' + (btn.class || '') + (!hasIcon ? ' ' + prefix + 'textual-button' : ''),\n                    html: t.hasSvg && hasIcon ?\n                        '<svg><use xlink:href=\"' + t.svgPath + '#' + prefix + (btn.ico || btnName).replace(/([A-Z]+)/g, '-$1').toLowerCase() + '\"/></svg>' :\n                        t.hideButtonTexts ? '' : (btn.text || btn.title || t.lang[btnName] || btnName),\n                    title: (btn.title || btn.text || textDef) + (btn.key ? ' (' + (t.isMac ? 'Cmd' : 'Ctrl') + ' + ' + btn.key + ')' : ''),\n                    tabindex: -1,\n                    mousedown: function () {\n                        if (!isDropdown || $('.' + btnName + '-' + prefix + 'dropdown', t.$box).is(':hidden')) {\n                            $('body', t.doc).trigger('mousedown');\n                        }\n\n                        if ((t.$btnPane.hasClass(prefix + 'disable') || t.$box.hasClass(prefix + 'disabled')) &&\n                            !$(this).hasClass(prefix + 'active') &&\n                            !$(this).hasClass(prefix + 'not-disable')) {\n                            return false;\n                        }\n\n                        t.execCmd((isDropdown ? 'dropdown' : false) || btn.fn || btnName, btn.param || btnName, btn.forceCss);\n\n                        return false;\n                    }\n                });\n\n            if (isDropdown) {\n                $btn.addClass(prefix + 'open-dropdown');\n                var dropdownPrefix = prefix + 'dropdown',\n                    dropdownOptions = { // the dropdown\n                        class: dropdownPrefix + '-' + btnName + ' ' + dropdownPrefix + ' ' + prefix + 'fixed-top ' + (btn.dropdownClass || '')\n                    };\n                dropdownOptions['data-' + dropdownPrefix] = btnName;\n                var $dropdown = $('<div/>', dropdownOptions);\n                $.each(isDropdown, function (i, def) {\n                    if (t.btnsDef[def] && t.isSupportedBtn(def)) {\n                        $dropdown.append(t.buildSubBtn(def));\n                    }\n                });\n                t.$box.append($dropdown.hide());\n            } else if (btn.key) {\n                t.keys[btn.key] = {\n                    fn: btn.fn || btnName,\n                    param: btn.param || btnName\n                };\n            }\n\n            if (!isDropdown) {\n                t.tagToButton[(btn.tag || btnName).toLowerCase()] = btnName;\n            }\n\n            return $btn;\n        },\n        // Build a button for dropdown menu\n        // @param n : name of the subbutton\n        buildSubBtn: function (btnName) {\n            var t = this,\n                prefix = t.o.prefix,\n                btn = t.btnsDef[btnName],\n                hasIcon = btn.hasIcon != null ? btn.hasIcon : true;\n\n            if (btn.key) {\n                t.keys[btn.key] = {\n                    fn: btn.fn || btnName,\n                    param: btn.param || btnName\n                };\n            }\n\n            t.tagToButton[(btn.tag || btnName).toLowerCase()] = btnName;\n\n            return $('<button/>', {\n                type: 'button',\n                class: prefix + btnName + '-dropdown-button ' + (btn.class || '') + (btn.ico ? ' ' + prefix + btn.ico + '-button' : ''),\n                html: t.hasSvg && hasIcon ?\n                    '<svg><use xlink:href=\"' + t.svgPath + '#' + prefix + (btn.ico || btnName).replace(/([A-Z]+)/g, '-$1').toLowerCase() + '\"/></svg>' + (btn.text || btn.title || t.lang[btnName] || btnName) :\n                    (btn.text || btn.title || t.lang[btnName] || btnName),\n                title: (btn.key ? '(' + (t.isMac ? 'Cmd' : 'Ctrl') + ' + ' + btn.key + ')' : null),\n                style: btn.style || null,\n                mousedown: function () {\n                    $('body', t.doc).trigger('mousedown');\n\n                    t.execCmd(btn.fn || btnName, btn.param || btnName, btn.forceCss);\n\n                    return false;\n                }\n            });\n        },\n        // Check if button is supported\n        isSupportedBtn: function (btnName) {\n            try {\n                return this.btnsDef[btnName].isSupported();\n            } catch (e) {\n            }\n            return true;\n        },\n\n        // Build overlay for modal box\n        buildOverlay: function () {\n            var t = this;\n            t.$overlay = $('<div/>', {\n                class: t.o.prefix + 'overlay'\n            }).appendTo(t.$box);\n            return t.$overlay;\n        },\n        showOverlay: function () {\n            var t = this;\n            $(window).trigger('scroll');\n            t.$overlay.fadeIn(200);\n            t.$box.addClass(t.o.prefix + 'box-blur');\n        },\n        hideOverlay: function () {\n            var t = this;\n            t.$overlay.fadeOut(50);\n            t.$box.removeClass(t.o.prefix + 'box-blur');\n        },\n\n        // Management of fixed button pane\n        fixedBtnPaneEvents: function () {\n            var t = this,\n                fixedFullWidth = t.o.fixedFullWidth,\n                $box = t.$box;\n\n            if (!t.o.fixedBtnPane) {\n                return;\n            }\n\n            t.isFixed = false;\n\n            $(window)\n                .on('scroll.' + t.eventNamespace + ' resize.' + t.eventNamespace, function () {\n                    if (!$box) {\n                        return;\n                    }\n\n                    t.syncCode();\n\n                    var scrollTop = $(window).scrollTop(),\n                        offset = $box.offset().top + 1,\n                        $buttonPane = t.$btnPane,\n                        buttonPaneOuterHeight = $buttonPane.outerHeight() - 2;\n\n                    if ((scrollTop - offset > 0) && ((scrollTop - offset - t.height) < 0)) {\n                        if (!t.isFixed) {\n                            t.isFixed = true;\n                            $buttonPane.css({\n                                position: 'fixed',\n                                top: 0,\n                                left: fixedFullWidth ? 0 : 'auto',\n                                zIndex: 7\n                            });\n                            t.$box.css({paddingTop: $buttonPane.height()});\n                        }\n                        $buttonPane.css({\n                            width: fixedFullWidth ? '100%' : (($box.width() - 1))\n                        });\n\n                        $('.' + t.o.prefix + 'fixed-top', $box).css({\n                            position: fixedFullWidth ? 'fixed' : 'absolute',\n                            top: fixedFullWidth ? buttonPaneOuterHeight : buttonPaneOuterHeight + (scrollTop - offset),\n                            zIndex: 15\n                        });\n                    } else if (t.isFixed) {\n                        t.isFixed = false;\n                        $buttonPane.removeAttr('style');\n                        t.$box.css({paddingTop: 0});\n                        $('.' + t.o.prefix + 'fixed-top', $box).css({\n                            position: 'absolute',\n                            top: buttonPaneOuterHeight\n                        });\n                    }\n                });\n        },\n\n        // Disable editor\n        setDisabled: function (disable) {\n            var t = this,\n                prefix = t.o.prefix;\n\n            t.disabled = disable;\n\n            if (disable) {\n                t.$ta.attr('disabled', true);\n            } else {\n                t.$ta.removeAttr('disabled');\n            }\n            t.$box.toggleClass(prefix + 'disabled', disable);\n            t.$ed.attr('contenteditable', !disable);\n        },\n\n        // Destroy the editor\n        destroy: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            if (t.isTextarea) {\n                t.$box.after(\n                    t.$ta\n                        .css({height: ''})\n                        .val(t.html())\n                        .removeClass(prefix + 'textarea')\n                        .show()\n                );\n            } else {\n                t.$box.after(\n                    t.$ed\n                        .css({height: ''})\n                        .removeClass(prefix + 'editor')\n                        .removeAttr('contenteditable')\n                        .removeAttr('dir')\n                        .html(t.html())\n                        .show()\n                );\n            }\n\n            t.$ed.off('dblclick', 'img');\n\n            t.destroyPlugins();\n\n            t.$box.remove();\n            t.$c.removeData('trumbowyg');\n            $('body').removeClass(prefix + 'body-fullscreen');\n            t.$c.trigger('tbwclose');\n            $(window).off('scroll.' + t.eventNamespace + ' resize.' + t.eventNamespace);\n            $(t.doc.body).off('keydown.' + t.eventNamespace);\n        },\n\n\n        // Empty the editor\n        empty: function () {\n            this.$ta.val('');\n            this.syncCode(true);\n        },\n\n\n        // Function call when click on viewHTML button\n        toggle: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            if (t.o.autogrowOnEnter) {\n                t.autogrowOnEnterDontClose = !t.$box.hasClass(prefix + 'editor-hidden');\n            }\n\n            t.semanticCode(false, true);\n            t.$c.trigger('tbwchange');\n\n            setTimeout(function () {\n                t.doc.activeElement.blur();\n                t.$box.toggleClass(prefix + 'editor-hidden ' + prefix + 'editor-visible');\n                t.$btnPane.toggleClass(prefix + 'disable');\n                $('.' + prefix + 'viewHTML-button', t.$btnPane).toggleClass(prefix + 'active');\n                if (t.$box.hasClass(prefix + 'editor-visible')) {\n                    t.$ta.attr('tabindex', -1);\n                } else {\n                    t.$ta.removeAttr('tabindex');\n                }\n\n                if (t.o.autogrowOnEnter && !t.autogrowOnEnterDontClose) {\n                    t.autogrowEditorOnEnter();\n                }\n            }, 0);\n        },\n\n        // Remove or add flags to span tags to remove Chrome generated spans\n        toggleSpan: function (addFlag) {\n            var t = this;\n            t.$ed.find('span').each(function () {\n                if (addFlag === true) {\n                    $(this).attr('data-tbw-flag', true);\n                } else {\n                    if ($(this).attr('data-tbw-flag')) {\n                        $(this).removeAttr('data-tbw-flag');\n                    } else {\n                        $(this).contents().unwrap();\n                    }\n                }\n            });\n        },\n\n        // Open dropdown when click on a button which open that\n        dropdown: function (name) {\n            var t = this,\n                $body = $('body', t.doc),\n                prefix = t.o.prefix,\n                $dropdown = $('[data-' + prefix + 'dropdown=' + name + ']', t.$box),\n                $btn = $('.' + prefix + name + '-button', t.$btnPane),\n                show = $dropdown.is(':hidden');\n\n            $body.trigger('mousedown');\n\n            if (show) {\n                var btnOffsetLeft = $btn.offset().left;\n                $btn.addClass(prefix + 'active');\n\n                $dropdown.css({\n                    position: 'absolute',\n                    top: $btn.offset().top - t.$btnPane.offset().top + $btn.outerHeight(),\n                    left: (t.o.fixedFullWidth && t.isFixed) ? btnOffsetLeft : (btnOffsetLeft - t.$btnPane.offset().left)\n                }).show();\n\n                $(window).trigger('scroll');\n\n                $body.on('mousedown.' + t.eventNamespace, function (e) {\n                    if (!$dropdown.is(e.target)) {\n                        $('.' + prefix + 'dropdown', t.$box).hide();\n                        $('.' + prefix + 'active', t.$btnPane).removeClass(prefix + 'active');\n                        $body.off('mousedown.' + t.eventNamespace);\n                    }\n                });\n            }\n        },\n\n\n        // HTML Code management\n        html: function (html) {\n            var t = this;\n\n            if (html != null) {\n                t.$ta.val(html);\n                t.syncCode(true);\n                t.$c.trigger('tbwchange');\n                return t;\n            }\n\n            return t.$ta.val();\n        },\n        syncTextarea: function () {\n            var t = this;\n            t.$ta.val(t.$ed.text().trim().length > 0 || t.$ed.find(t.o.tagsToKeep.join(',')).length > 0 ? t.$ed.html() : '');\n        },\n        syncCode: function (force) {\n            var t = this;\n            if (!force && t.$ed.is(':visible')) {\n                t.syncTextarea();\n            } else {\n                // wrap the content in a div it's easier to get the inner html\n                var html = $('<div>').html(t.$ta.val());\n                // scrub the html before loading into the doc\n                var safe = $('<div>').append(html);\n                $(t.o.tagsToRemove.join(','), safe).remove();\n                t.$ed.html(safe.contents().html());\n            }\n\n            if (t.o.autogrow) {\n                t.height = t.$ed.height();\n                if (t.height !== t.$ta.css('height')) {\n                    t.$ta.css({height: t.height});\n                    t.$c.trigger('tbwresize');\n                }\n            }\n            if (t.o.autogrowOnEnter) {\n                t.$ed.height('auto');\n                var totalHeight = t.autogrowOnEnterWasFocused ? t.$ed[0].scrollHeight : t.$ed.css('min-height');\n                if (totalHeight !== t.$ta.css('height')) {\n                    t.$ed.css({height: totalHeight});\n                    t.$c.trigger('tbwresize');\n                }\n            }\n        },\n\n        // Analyse and update to semantic code\n        // @param force : force to sync code from textarea\n        // @param full  : wrap text nodes in <p>\n        // @param keepRange  : leave selection range as it is\n        semanticCode: function (force, full, keepRange) {\n            var t = this;\n            t.saveRange();\n            t.syncCode(force);\n\n            var restoreRange = true;\n            if (t.range && t.range.collapsed) {\n                restoreRange = false;\n            }\n\n            if (t.o.semantic) {\n                t.semanticTag('b', t.o.semanticKeepAttributes);\n                t.semanticTag('i', t.o.semanticKeepAttributes);\n                t.semanticTag('s', t.o.semanticKeepAttributes);\n                t.semanticTag('strike', t.o.semanticKeepAttributes);\n\n                if (full) {\n                    var inlineElementsSelector = t.o.inlineElementsSelector,\n                        blockElementsSelector = ':not(' + inlineElementsSelector + ')';\n\n                    // Wrap text nodes in span for easier processing\n                    t.$ed.contents().filter(function () {\n                        return this.nodeType === 3 && this.nodeValue.trim().length > 0;\n                    }).wrap('<span data-tbw/>');\n\n                    // Wrap groups of inline elements in paragraphs (recursive)\n                    var wrapInlinesInParagraphsFrom = function ($from) {\n                        if ($from.length !== 0) {\n                            var $finalParagraph = $from.nextUntil(blockElementsSelector).addBack().wrapAll('<p/>').parent(),\n                                $nextElement = $finalParagraph.nextAll(inlineElementsSelector).first();\n                            $finalParagraph.next('br').remove();\n                            wrapInlinesInParagraphsFrom($nextElement);\n                        }\n                    };\n                    wrapInlinesInParagraphsFrom(t.$ed.children(inlineElementsSelector).first());\n\n                    t.semanticTag('div', true);\n\n                    // Get rid of temporary span's\n                    $('[data-tbw]', t.$ed).contents().unwrap();\n\n                    // Remove empty <p>\n                    t.$ed.find('p:empty').remove();\n                }\n\n                if (!keepRange && restoreRange) {\n                    t.restoreRange();\n                }\n\n                t.syncTextarea();\n            }\n        },\n\n        semanticTag: function (oldTag, copyAttributes, revert) {\n            var newTag, t = this;\n            var tmpTag = oldTag;\n\n            if (this.o.semantic != null && typeof this.o.semantic === 'object' && this.o.semantic.hasOwnProperty(oldTag)) {\n                newTag = this.o.semantic[oldTag];\n            } else if (this.o.semantic === true && this.DEFAULT_SEMANTIC_MAP.hasOwnProperty(oldTag)) {\n                newTag = this.DEFAULT_SEMANTIC_MAP[oldTag];\n            } else {\n                return;\n            }\n\n            if(revert) {\n                oldTag = newTag;\n                newTag = tmpTag;\n            }\n\n            $(oldTag, this.$ed).each(function () {\n                var resetRange = false;\n                var $oldTag = $(this);\n                if ($oldTag.contents().length === 0) {\n                    return false;\n                }\n\n                if (t.range && t.range.startContainer.parentNode === this) {\n                    resetRange = true;\n                }\n                var $newTag = $('<' + newTag + '/>');\n                $newTag.insertBefore($oldTag);\n                if (copyAttributes) {\n                    $.each($oldTag.prop('attributes'), function () {\n                        $newTag.attr(this.name, this.value);\n                    });\n                }\n                $newTag.html($oldTag.html());\n                $oldTag.remove();\n                if(resetRange === true) {\n                    t.range.selectNodeContents($newTag.get(0));\n                    t.range.collapse(false);\n                }\n            });\n        },\n\n        // Function call when user click on \"Insert Link\"\n        createLink: function () {\n            var t = this,\n                documentSelection = t.doc.getSelection(),\n                selectedRange = documentSelection.getRangeAt(0),\n                node = documentSelection.focusNode,\n                text = new XMLSerializer().serializeToString(selectedRange.cloneContents()) || selectedRange + '',\n                url,\n                title,\n                target;\n\n            while (['A', 'DIV'].indexOf(node.nodeName) < 0) {\n                node = node.parentNode;\n            }\n\n            if (node && node.nodeName === 'A') {\n                var $a = $(node);\n                text = $a.text();\n                url = $a.attr('href');\n                if (!t.o.minimalLinks) {\n                    title = $a.attr('title');\n                    target = $a.attr('target') || t.o.defaultLinkTarget;\n                }\n                var range = t.doc.createRange();\n                range.selectNode(node);\n                documentSelection.removeAllRanges();\n                documentSelection.addRange(range);\n            }\n\n            t.saveRange();\n\n            var options = {\n                url: {\n                    label: t.lang.linkUrl || 'URL',\n                    required: true,\n                    value: url\n                },\n                text: {\n                    label: t.lang.text,\n                    value: text\n                }\n            };\n            if (!t.o.minimalLinks) {\n                $.extend(options, {\n                    title: {\n                        label: t.lang.title,\n                        value: title\n                    },\n                    target: {\n                        label: t.lang.target,\n                        value: target\n                    }\n                });\n            }\n\n            t.openModalInsert(t.lang.createLink, options, function (v) { // v is value\n                var url = t.prependUrlPrefix(v.url);\n                if (!url.length) {\n                    return false;\n                }\n\n                var link = $(['<a href=\"', url, '\">', v.text || v.url, '</a>'].join(''));\n\n                if (v.title) {\n                    link.attr('title', v.title);\n                }\n                if (v.target || t.o.defaultLinkTarget) {\n                    link.attr('target', v.target || t.o.defaultLinkTarget);\n                }\n                t.range.deleteContents();\n                t.range.insertNode(link[0]);\n                t.syncCode();\n                t.$c.trigger('tbwchange');\n                return true;\n            });\n        },\n        prependUrlPrefix: function (url) {\n            var t = this;\n            if (!t.urlPrefix) {\n                return url;\n            }\n\n            var VALID_LINK_PREFIX = /^([a-z][-+.a-z0-9]*:|\\/|#)/i;\n            if (VALID_LINK_PREFIX.test(url)) {\n                return url;\n            }\n\n            var SIMPLE_EMAIL_REGEX = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n            if (SIMPLE_EMAIL_REGEX.test(url)) {\n                return 'mailto:' + url;\n            }\n\n            return t.urlPrefix + url;\n        },\n        unlink: function () {\n            var t = this,\n                documentSelection = t.doc.getSelection(),\n                node = documentSelection.focusNode;\n\n            if (documentSelection.isCollapsed) {\n                while (['A', 'DIV'].indexOf(node.nodeName) < 0) {\n                    node = node.parentNode;\n                }\n\n                if (node && node.nodeName === 'A') {\n                    var range = t.doc.createRange();\n                    range.selectNode(node);\n                    documentSelection.removeAllRanges();\n                    documentSelection.addRange(range);\n                }\n            }\n            t.execCmd('unlink', undefined, undefined, true);\n        },\n        insertImage: function () {\n            var t = this;\n            t.saveRange();\n\n            var options = {\n                url: {\n                    label: 'URL',\n                    required: true\n                },\n                alt: {\n                    label: t.lang.description,\n                    value: t.getRangeText()\n                }\n            };\n\n            if (t.o.imageWidthModalEdit) {\n                options.width = {};\n            }\n\n            t.openModalInsert(t.lang.insertImage, options, function (v) { // v are values\n                t.execCmd('insertImage', v.url, false, true);\n                var $img = $('img[src=\"' + v.url + '\"]:not([alt])', t.$box);\n                $img.attr('alt', v.alt);\n\n                if (t.o.imageWidthModalEdit) {\n                    $img.attr({\n                        width: v.width\n                    });\n                }\n\n                t.syncCode();\n                t.$c.trigger('tbwchange');\n\n                return true;\n            });\n        },\n        fullscreen: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                fullscreenCssClass = prefix + 'fullscreen',\n                fullscreenPlaceholderClass = fullscreenCssClass + '-placeholder',\n                isFullscreen,\n                editorHeight = t.$box.outerHeight();\n\n            t.$box.toggleClass(fullscreenCssClass);\n            isFullscreen = t.$box.hasClass(fullscreenCssClass);\n\n            if (isFullscreen) {\n                t.$box.before(\n                    $('<div/>', {\n                        class: fullscreenPlaceholderClass\n                    }).css({\n                        height: editorHeight\n                    })\n                );\n            } else {\n                $('.' + fullscreenPlaceholderClass).remove();\n            }\n\n            $('body').toggleClass(prefix + 'body-fullscreen', isFullscreen);\n            $(window).trigger('scroll');\n            t.$c.trigger('tbw' + (isFullscreen ? 'open' : 'close') + 'fullscreen');\n        },\n\n\n        /*\n         * Call method of trumbowyg if exist\n         * else try to call anonymous function\n         * and finally native execCommand\n         */\n        execCmd: function (cmd, param, forceCss, skipTrumbowyg) {\n            var t = this;\n            skipTrumbowyg = !!skipTrumbowyg || '';\n\n            if (cmd !== 'dropdown') {\n                t.$ed.focus();\n            }\n\n            if(cmd === 'strikethrough' && t.o.semantic) {\n                t.semanticTag('strike', t.o.semanticKeepAttributes, true); // browsers cannot undo e.g. <del> as they expect <strike>\n            }\n\n            try {\n                t.doc.execCommand('styleWithCSS', false, forceCss || false);\n            } catch (c) {\n            }\n\n            try {\n                t[cmd + skipTrumbowyg](param);\n            } catch (c) {\n                try {\n                    cmd(param);\n                } catch (e2) {\n                    if (cmd === 'insertHorizontalRule') {\n                        param = undefined;\n                    } else if (cmd === 'formatBlock' && t.isIE) {\n                        param = '<' + param + '>';\n                    }\n\n                    t.doc.execCommand(cmd, false, param);\n\n                    t.syncCode();\n                    t.semanticCode(false, true);\n                    try {\n                        var listId = window.getSelection().focusNode;\n                        if(!$(window.getSelection().focusNode.parentNode).hasClass('trumbowyg-editor')){\n                            listId = window.getSelection().focusNode.parentNode;\n                        }\n                        var classes = t.o.tagClasses[param];\n                        if (classes) {\n                            $(listId).addClass(classes);\n                        }\n                    } catch (e) {\n\n                    }\n\n                }\n\n                if (cmd !== 'dropdown') {\n                    t.updateButtonPaneStatus();\n                    t.$c.trigger('tbwchange');\n                }\n            }\n        },\n\n\n        // Open a modal box\n        openModal: function (title, content, buildForm) {\n            var t = this,\n                prefix = t.o.prefix;\n\n            buildForm = buildForm !== false;\n\n            // No open a modal box when exist other modal box\n            if ($('.' + prefix + 'modal-box', t.$box).length > 0) {\n                return false;\n            }\n            if (t.o.autogrowOnEnter) {\n                t.autogrowOnEnterDontClose = true;\n            }\n\n            t.saveRange();\n            t.showOverlay();\n\n            // Disable all btnPane btns\n            t.$btnPane.addClass(prefix + 'disable');\n\n            // Build out of ModalBox, it's the mask for animations\n            var $modal = $('<div/>', {\n                class: prefix + 'modal ' + prefix + 'fixed-top'\n            }).css({\n                top: t.$box.offset().top + t.$btnPane.height(),\n                zIndex: 99999\n            }).appendTo($(t.doc.body));\n\n            // Click on overlay close modal by cancelling them\n            t.$overlay.one('click', function () {\n                $modal.trigger(CANCEL_EVENT);\n                return false;\n            });\n\n            // Build the form\n            var formOrContent;\n            if (buildForm) {\n                formOrContent = $('<form/>', {\n                    action: '',\n                    html: content\n                })\n                    .on('submit', function () {\n                        $modal.trigger(CONFIRM_EVENT);\n                        return false;\n                    })\n                    .on('reset', function () {\n                        $modal.trigger(CANCEL_EVENT);\n                        return false;\n                    })\n                    .on('submit reset', function () {\n                        if (t.o.autogrowOnEnter) {\n                            t.autogrowOnEnterDontClose = false;\n                        }\n                    });\n            } else {\n                formOrContent = content;\n            }\n\n\n            // Build ModalBox and animate to show them\n            var $box = $('<div/>', {\n                class: prefix + 'modal-box',\n                html: formOrContent\n            })\n                .css({\n                    top: '-' + t.$btnPane.outerHeight(),\n                    opacity: 0,\n                    paddingBottom: buildForm ? null : '5%',\n                })\n                .appendTo($modal)\n                .animate({\n                    top: 0,\n                    opacity: 1\n                }, 100);\n\n\n            // Append title\n            if (title) {\n                $('<span/>', {\n                    text: title,\n                    class: prefix + 'modal-title'\n                }).prependTo($box);\n            }\n\n            if (buildForm) {\n                // Focus in modal box\n                $(':input:first', $box).focus();\n\n                // Append Confirm and Cancel buttons\n                t.buildModalBtn('submit', $box);\n                t.buildModalBtn('reset', $box);\n\n                $modal.height($box.outerHeight() + 10);\n            }\n\n            $(window).trigger('scroll');\n            t.$c.trigger('tbwmodalopen');\n\n            return $modal;\n        },\n        // @param n is name of modal\n        buildModalBtn: function (n, $modal) {\n            var t = this,\n                prefix = t.o.prefix;\n\n            return $('<button/>', {\n                class: prefix + 'modal-button ' + prefix + 'modal-' + n,\n                type: n,\n                text: t.lang[n] || n\n            }).appendTo($('form', $modal));\n        },\n        // close current modal box\n        closeModal: function () {\n            var t = this,\n                prefix = t.o.prefix;\n\n            t.$btnPane.removeClass(prefix + 'disable');\n            t.$overlay.off();\n\n            // Find the modal box\n            var $modalBox = $('.' + prefix + 'modal-box', $(t.doc.body));\n\n            $modalBox.animate({\n                top: '-' + $modalBox.height()\n            }, 100, function () {\n                $modalBox.parent().remove();\n                t.hideOverlay();\n                t.$c.trigger('tbwmodalclose');\n            });\n\n            t.restoreRange();\n        },\n        // Pre-formatted build and management modal\n        openModalInsert: function (title, fields, cmd) {\n            var t = this,\n                prefix = t.o.prefix,\n                lg = t.lang,\n                html = '',\n                idPrefix = prefix + 'form-' + Date.now() + '-';\n\n            $.each(fields, function (fieldName, field) {\n                var l = field.label || fieldName,\n                    n = field.name || fieldName,\n                    a = field.attributes || {},\n                    fieldId = idPrefix + fieldName;\n\n                var attr = Object.keys(a).map(function (prop) {\n                    return prop + '=\"' + a[prop] + '\"';\n                }).join(' ');\n\n                if (typeof field.type === 'function') {\n                  if (!field.name) {\n                    field.name = n;\n                  }\n                  html += field.type(field, fieldId, prefix, lg);\n                } else {\n                  html += '<div class=\"' + prefix + 'input-row\">' +\n                    '<div class=\"' + prefix + 'input-infos\"><label for=\"' + fieldId + '\"><span>' + (lg[l] ? lg[l] : l) + '</span></label></div>' +\n                    '<div class=\"' + prefix + 'input-html\"><input id=\"' + fieldId + '\" type=\"' + (field.type || 'text') + '\" name=\"' + n + '\" ' + attr;\n                    html += (field.type === 'checkbox' && field.value ? ' checked=\"checked\"' : '') + ' value=\"' + (field.value || '').replace(/\"/g, '&quot;') + '\"></div>';\n                  html += '</div>';\n                }\n            });\n\n            return t.openModal(title, html)\n                .on(CONFIRM_EVENT, function () {\n                    var $form = $('form', $(this)),\n                        valid = true,\n                        values = {};\n\n                    $.each(fields, function (fieldName, field) {\n                        var n = field.name || fieldName;\n\n                        var $field = $(':input[name=\"' + n + '\"]', $form),\n                            inputType = $field[0].type;\n\n                        switch (inputType.toLowerCase()) {\n                            case 'checkbox':\n                                values[n] = $field.is(':checked');\n                                break;\n                            case 'radio':\n                                values[n] = $field.filter(':checked').val();\n                                break;\n                            default:\n                                values[n] = $.trim($field.val());\n                                break;\n                        }\n                        // Validate value\n                        if (field.required && values[n] === '') {\n                            valid = false;\n                            t.addErrorOnModalField($field, t.lang.required);\n                        } else if (field.pattern && !field.pattern.test(values[n])) {\n                            valid = false;\n                            t.addErrorOnModalField($field, field.patternError);\n                        }\n                    });\n\n                    if (valid) {\n                        t.restoreRange();\n\n                        if (cmd(values, fields)) {\n                            t.syncCode();\n                            t.$c.trigger('tbwchange');\n                            t.closeModal();\n                            $(this).off(CONFIRM_EVENT);\n                        }\n                    }\n                })\n                .one(CANCEL_EVENT, function () {\n                    $(this).off(CONFIRM_EVENT);\n                    t.closeModal();\n                });\n        },\n        addErrorOnModalField: function ($field, err) {\n            var prefix = this.o.prefix,\n                spanErrorClass = prefix + 'msg-error',\n                $row = $field.closest('.' + prefix + 'input-row');\n\n            $field\n                .on('change keyup', function () {\n                    $row.removeClass(prefix + 'input-error');\n                    setTimeout(function () {\n                        $row.find('.' + spanErrorClass).remove();\n                    }, 150);\n                });\n\n            $row\n                .addClass(prefix + 'input-error')\n                .find('.' + prefix + 'input-infos label')\n                .append(\n                    $('<span/>', {\n                        class: spanErrorClass,\n                        text: err\n                    })\n                );\n        },\n\n        getDefaultImgDblClickHandler: function () {\n            var t = this;\n\n            return function () {\n                var $img = $(this),\n                    src = $img.attr('src'),\n                    base64 = '(Base64)';\n\n                if (src.indexOf('data:image') === 0) {\n                    src = base64;\n                }\n\n                var options = {\n                    url: {\n                        label: 'URL',\n                        value: src,\n                        required: true\n                    },\n                    alt: {\n                        label: t.lang.description,\n                        value: $img.attr('alt')\n                    }\n                };\n\n                if (t.o.imageWidthModalEdit) {\n                    options.width = {\n                        value: $img.attr('width') ? $img.attr('width') : ''\n                    };\n                }\n\n                t.openModalInsert(t.lang.insertImage, options, function (v) {\n                    if (v.url !== base64) {\n                        $img.attr({\n                            src: v.url\n                        });\n                    }\n                    $img.attr({\n                        alt: v.alt\n                    });\n\n                    if (t.o.imageWidthModalEdit) {\n                        if (parseInt(v.width) > 0) {\n                            $img.attr({\n                                width: v.width\n                            });\n                        } else {\n                            $img.removeAttr('width');\n                        }\n                    }\n\n                    return true;\n                });\n                return false;\n            };\n        },\n\n        // Range management\n        saveRange: function () {\n            var t = this,\n                documentSelection = t.doc.getSelection();\n\n            t.range = null;\n\n            if (!documentSelection || !documentSelection.rangeCount) {\n                return;\n            }\n\n            var savedRange = t.range = documentSelection.getRangeAt(0),\n                range = t.doc.createRange(),\n                rangeStart;\n            range.selectNodeContents(t.$ed[0]);\n            range.setEnd(savedRange.startContainer, savedRange.startOffset);\n            rangeStart = (range + '').length;\n            t.metaRange = {\n                start: rangeStart,\n                end: rangeStart + (savedRange + '').length\n            };\n        },\n        restoreRange: function () {\n            var t = this,\n                metaRange = t.metaRange,\n                savedRange = t.range,\n                documentSelection = t.doc.getSelection(),\n                range;\n\n            if (!savedRange) {\n                return;\n            }\n\n            if (metaRange && metaRange.start !== metaRange.end) { // Algorithm from http://jsfiddle.net/WeWy7/3/\n                var charIndex = 0,\n                    nodeStack = [t.$ed[0]],\n                    node,\n                    foundStart = false,\n                    stop = false;\n\n                range = t.doc.createRange();\n\n                while (!stop && (node = nodeStack.pop())) {\n                    if (node.nodeType === 3) {\n                        var nextCharIndex = charIndex + node.length;\n                        if (!foundStart && metaRange.start >= charIndex && metaRange.start <= nextCharIndex) {\n                            range.setStart(node, metaRange.start - charIndex);\n                            foundStart = true;\n                        }\n                        if (foundStart && metaRange.end >= charIndex && metaRange.end <= nextCharIndex) {\n                            range.setEnd(node, metaRange.end - charIndex);\n                            stop = true;\n                        }\n                        charIndex = nextCharIndex;\n                    } else {\n                        var cn = node.childNodes,\n                            i = cn.length;\n\n                        while (i > 0) {\n                            i -= 1;\n                            nodeStack.push(cn[i]);\n                        }\n                    }\n                }\n            }\n\n            // Fix IE11 Error 'Could not complete the operation due to error 800a025e'.\n            // https://stackoverflow.com/questions/16160996/could-not-complete-the-operation-due-to-error-800a025e\n            try {\n                documentSelection.removeAllRanges();\n            } catch (e) {\n            }\n\n            documentSelection.addRange(range || savedRange);\n        },\n        getRangeText: function () {\n            return this.range + '';\n        },\n\n        clearButtonPaneStatus: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                activeClasses = prefix + 'active-button ' + prefix + 'active',\n                originalIconClass = prefix + 'original-icon';\n\n            // Reset all buttons and dropdown state\n            $('.' + prefix + 'active-button', t.$btnPane).removeClass(activeClasses);\n            $('.' + originalIconClass, t.$btnPane).each(function () {\n                $(this).find('svg use').attr('xlink:href', $(this).data(originalIconClass));\n            });\n        },\n        updateButtonPaneStatus: function () {\n            var t = this,\n                prefix = t.o.prefix,\n                activeClasses = prefix + 'active-button ' + prefix + 'active',\n                originalIconClass = prefix + 'original-icon',\n                tags = t.getTagsRecursive(t.doc.getSelection().focusNode);\n\n            t.clearButtonPaneStatus();\n\n            $.each(tags, function (i, tag) {\n                var btnName = t.tagToButton[tag.toLowerCase()],\n                    $btn = $('.' + prefix + btnName + '-button', t.$btnPane);\n\n                if ($btn.length > 0) {\n                    $btn.addClass(activeClasses);\n                } else {\n                    try {\n                        $btn = $('.' + prefix + 'dropdown .' + prefix + btnName + '-dropdown-button', t.$box);\n                        var $btnSvgUse = $btn.find('svg use'),\n                            dropdownBtnName = $btn.parent().data(prefix + 'dropdown'),\n                            $dropdownBtn = $('.' + prefix + dropdownBtnName + '-button', t.$box),\n                            $dropdownBtnSvgUse = $dropdownBtn.find('svg use');\n\n                        // Highlight the dropdown button\n                        $dropdownBtn.addClass(activeClasses);\n\n                        // Switch dropdown icon to the active sub-icon one\n                        if (t.o.changeActiveDropdownIcon && $btnSvgUse.length > 0) {\n                            // Save original icon\n                            $dropdownBtn\n                                .addClass(originalIconClass)\n                                .data(originalIconClass, $dropdownBtnSvgUse.attr('xlink:href'));\n\n                            // Put the active sub-button's icon\n                            $dropdownBtnSvgUse\n                                .attr('xlink:href', $btnSvgUse.attr('xlink:href'));\n                        }\n                    } catch (e) {\n                    }\n                }\n            });\n        },\n        getTagsRecursive: function (element, tags) {\n            var t = this;\n            tags = tags || (element && element.tagName ? [element.tagName] : []);\n\n            if (element && element.parentNode) {\n                element = element.parentNode;\n            } else {\n                return tags;\n            }\n\n            var tag = element.tagName;\n            if (tag === 'DIV') {\n                return tags;\n            }\n            if (tag === 'P' && element.style.textAlign !== '') {\n                tags.push(element.style.textAlign);\n            }\n\n            $.each(t.tagHandlers, function (i, tagHandler) {\n                tags = tags.concat(tagHandler(element, t));\n            });\n\n            tags.push(tag);\n\n            return t.getTagsRecursive(element, tags).filter(function (tag) {\n                return tag != null;\n            });\n        },\n\n        // Plugins\n        initPlugins: function () {\n            var t = this;\n            t.loadedPlugins = [];\n            $.each($.trumbowyg.plugins, function (name, plugin) {\n                if (!plugin.shouldInit || plugin.shouldInit(t)) {\n                    plugin.init(t);\n                    if (plugin.tagHandler) {\n                        t.tagHandlers.push(plugin.tagHandler);\n                    }\n                    t.loadedPlugins.push(plugin);\n                }\n            });\n        },\n        destroyPlugins: function () {\n            var t = this;\n            $.each(this.loadedPlugins, function (i, plugin) {\n                if (plugin.destroy) {\n                    plugin.destroy(t);\n                }\n            });\n        }\n    };\n})(navigator, window, document, jQuery);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdHJ1bWJvd3lnL2Rpc3QvdHJ1bWJvd3lnLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQSxlQUFlOztBQUVmO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQSxtQkFBbUI7O0FBRW5CO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQjtBQUMvQiw4QkFBOEI7O0FBRTlCOztBQUVBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEMsVUFBVTtBQUNWO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdGQUFnRjtBQUNoRixjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUVBQXFFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixzQkFBc0I7O0FBRXRCLDJCQUEyQjs7QUFFM0I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0EsYUFBYTs7QUFFYiw0QkFBNEI7O0FBRTVCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTOztBQUVUO0FBQ0EsZ0ZBQWdGO0FBQ2hGLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7O0FBRUE7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhOztBQUViOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy90cnVtYm93eWcvZGlzdC90cnVtYm93eWcuanM/ZGNmOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRydW1ib3d5ZyB2Mi4yNS4xIC0gQSBsaWdodHdlaWdodCBXWVNJV1lHIGVkaXRvclxuICogVHJ1bWJvd3lnIGNvcmUgZmlsZVxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBAbGluayBodHRwOi8vYWxleC1kLmdpdGh1Yi5pby9UcnVtYm93eWdcbiAqIEBsaWNlbnNlIE1JVFxuICogQGF1dGhvciBBbGV4YW5kcmUgRGVtb2RlIChBbGV4LUQpXG4gKiAgICAgICAgIFR3aXR0ZXIgOiBAQWxleGFuZHJlRGVtb2RlXG4gKiAgICAgICAgIFdlYnNpdGUgOiBhbGV4LWQuZnJcbiAqL1xuXG5qUXVlcnkudHJ1bWJvd3lnID0ge1xuICAgIGxhbmdzOiB7XG4gICAgICAgIGVuOiB7XG4gICAgICAgICAgICB2aWV3SFRNTDogJ1ZpZXcgSFRNTCcsXG5cbiAgICAgICAgICAgIHVuZG86ICdVbmRvJyxcbiAgICAgICAgICAgIHJlZG86ICdSZWRvJyxcblxuICAgICAgICAgICAgZm9ybWF0dGluZzogJ0Zvcm1hdHRpbmcnLFxuICAgICAgICAgICAgcDogJ1BhcmFncmFwaCcsXG4gICAgICAgICAgICBibG9ja3F1b3RlOiAnUXVvdGUnLFxuICAgICAgICAgICAgY29kZTogJ0NvZGUnLFxuICAgICAgICAgICAgaGVhZGVyOiAnSGVhZGVyJyxcblxuICAgICAgICAgICAgYm9sZDogJ0JvbGQnLFxuICAgICAgICAgICAgaXRhbGljOiAnSXRhbGljJyxcbiAgICAgICAgICAgIHN0cmlrZXRocm91Z2g6ICdTdHJpa2V0aHJvdWdoJyxcbiAgICAgICAgICAgIHVuZGVybGluZTogJ1VuZGVybGluZScsXG5cbiAgICAgICAgICAgIHN0cm9uZzogJ1N0cm9uZycsXG4gICAgICAgICAgICBlbTogJ0VtcGhhc2lzJyxcbiAgICAgICAgICAgIGRlbDogJ0RlbGV0ZWQnLFxuXG4gICAgICAgICAgICBzdXBlcnNjcmlwdDogJ1N1cGVyc2NyaXB0JyxcbiAgICAgICAgICAgIHN1YnNjcmlwdDogJ1N1YnNjcmlwdCcsXG5cbiAgICAgICAgICAgIHVub3JkZXJlZExpc3Q6ICdVbm9yZGVyZWQgbGlzdCcsXG4gICAgICAgICAgICBvcmRlcmVkTGlzdDogJ09yZGVyZWQgbGlzdCcsXG5cbiAgICAgICAgICAgIGluc2VydEltYWdlOiAnSW5zZXJ0IEltYWdlJyxcbiAgICAgICAgICAgIGxpbms6ICdMaW5rJyxcbiAgICAgICAgICAgIGNyZWF0ZUxpbms6ICdJbnNlcnQgbGluaycsXG4gICAgICAgICAgICB1bmxpbms6ICdSZW1vdmUgbGluaycsXG5cbiAgICAgICAgICAgIGp1c3RpZnlMZWZ0OiAnQWxpZ24gTGVmdCcsXG4gICAgICAgICAgICBqdXN0aWZ5Q2VudGVyOiAnQWxpZ24gQ2VudGVyJyxcbiAgICAgICAgICAgIGp1c3RpZnlSaWdodDogJ0FsaWduIFJpZ2h0JyxcbiAgICAgICAgICAgIGp1c3RpZnlGdWxsOiAnQWxpZ24gSnVzdGlmeScsXG5cbiAgICAgICAgICAgIGhvcml6b250YWxSdWxlOiAnSW5zZXJ0IGhvcml6b250YWwgcnVsZScsXG4gICAgICAgICAgICByZW1vdmVmb3JtYXQ6ICdSZW1vdmUgZm9ybWF0JyxcblxuICAgICAgICAgICAgZnVsbHNjcmVlbjogJ0Z1bGxzY3JlZW4nLFxuXG4gICAgICAgICAgICBjbG9zZTogJ0Nsb3NlJyxcblxuICAgICAgICAgICAgc3VibWl0OiAnQ29uZmlybScsXG4gICAgICAgICAgICByZXNldDogJ0NhbmNlbCcsXG5cbiAgICAgICAgICAgIHJlcXVpcmVkOiAnUmVxdWlyZWQnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdEZXNjcmlwdGlvbicsXG4gICAgICAgICAgICB0aXRsZTogJ1RpdGxlJyxcbiAgICAgICAgICAgIHRleHQ6ICdUZXh0JyxcbiAgICAgICAgICAgIHRhcmdldDogJ1RhcmdldCcsXG4gICAgICAgICAgICB3aWR0aDogJ1dpZHRoJ1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIFBsdWdpbnNcbiAgICBwbHVnaW5zOiB7fSxcblxuICAgIC8vIFNWRyBQYXRoIGdsb2JhbGx5XG4gICAgc3ZnUGF0aDogbnVsbCxcbiAgICBzdmdBYnNvbHV0ZVVzZUhyZWY6IGZhbHNlLFxuXG4gICAgaGlkZUJ1dHRvblRleHRzOiBudWxsXG59O1xuXG4vLyBNYWtlcyBkZWZhdWx0IG9wdGlvbnMgcmVhZC1vbmx5XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoalF1ZXJ5LnRydW1ib3d5ZywgJ2RlZmF1bHRPcHRpb25zJywge1xuICAgIHZhbHVlOiB7XG4gICAgICAgIGxhbmc6ICdlbicsXG5cbiAgICAgICAgZml4ZWRCdG5QYW5lOiBmYWxzZSxcbiAgICAgICAgZml4ZWRGdWxsV2lkdGg6IGZhbHNlLFxuICAgICAgICBhdXRvZ3JvdzogZmFsc2UsXG4gICAgICAgIGF1dG9ncm93T25FbnRlcjogZmFsc2UsXG4gICAgICAgIGltYWdlV2lkdGhNb2RhbEVkaXQ6IGZhbHNlLFxuICAgICAgICBoaWRlQnV0dG9uVGV4dHM6IG51bGwsXG5cbiAgICAgICAgcHJlZml4OiAndHJ1bWJvd3lnLScsXG4gICAgICAgIHRhZ0NsYXNzZXM6IHt9LFxuICAgICAgICBzZW1hbnRpYzogdHJ1ZSxcbiAgICAgICAgc2VtYW50aWNLZWVwQXR0cmlidXRlczogZmFsc2UsXG4gICAgICAgIHJlc2V0Q3NzOiBmYWxzZSxcbiAgICAgICAgcmVtb3ZlZm9ybWF0UGFzdGVkOiBmYWxzZSxcbiAgICAgICAgdGFiVG9JbmRlbnQ6IGZhbHNlLFxuICAgICAgICB0YWdzVG9SZW1vdmU6IFtdLFxuICAgICAgICB0YWdzVG9LZWVwOiBbJ2hyJywgJ2ltZycsICdlbWJlZCcsICdpZnJhbWUnLCAnaW5wdXQnXSxcbiAgICAgICAgYnRuczogW1xuICAgICAgICAgICAgWyd2aWV3SFRNTCddLFxuICAgICAgICAgICAgWyd1bmRvJywgJ3JlZG8nXSwgLy8gT25seSBzdXBwb3J0ZWQgaW4gQmxpbmsgYnJvd3NlcnNcbiAgICAgICAgICAgIFsnZm9ybWF0dGluZyddLFxuICAgICAgICAgICAgWydzdHJvbmcnLCAnZW0nLCAnZGVsJ10sXG4gICAgICAgICAgICBbJ3N1cGVyc2NyaXB0JywgJ3N1YnNjcmlwdCddLFxuICAgICAgICAgICAgWydsaW5rJ10sXG4gICAgICAgICAgICBbJ2luc2VydEltYWdlJ10sXG4gICAgICAgICAgICBbJ2p1c3RpZnlMZWZ0JywgJ2p1c3RpZnlDZW50ZXInLCAnanVzdGlmeVJpZ2h0JywgJ2p1c3RpZnlGdWxsJ10sXG4gICAgICAgICAgICBbJ3Vub3JkZXJlZExpc3QnLCAnb3JkZXJlZExpc3QnXSxcbiAgICAgICAgICAgIFsnaG9yaXpvbnRhbFJ1bGUnXSxcbiAgICAgICAgICAgIFsncmVtb3ZlZm9ybWF0J10sXG4gICAgICAgICAgICBbJ2Z1bGxzY3JlZW4nXVxuICAgICAgICBdLFxuICAgICAgICAvLyBGb3IgY3VzdG9tIGJ1dHRvbiBkZWZpbml0aW9uc1xuICAgICAgICBidG5zRGVmOiB7fSxcbiAgICAgICAgY2hhbmdlQWN0aXZlRHJvcGRvd25JY29uOiBmYWxzZSxcblxuICAgICAgICBpbmxpbmVFbGVtZW50c1NlbGVjdG9yOiAnYSxhYmJyLGFjcm9ueW0sYixjYXB0aW9uLGNpdGUsY29kZSxjb2wsZGZuLGRpcixkdCxkZCxlbSxmb250LGhyLGksa2JkLGxpLHEsc3BhbixzdHJpa2VvdXQsc3Ryb25nLHN1YixzdXAsdScsXG5cbiAgICAgICAgcGFzdGVIYW5kbGVyczogW10sXG5cbiAgICAgICAgLy8gaW1nRGJsQ2xpY2tIYW5kbGVyOiBkZWZhdWx0IGlzIGRlZmluZWQgaW4gY29uc3RydWN0b3JcblxuICAgICAgICBwbHVnaW5zOiB7fSxcblxuICAgICAgICB1cmxQcm90b2NvbDogZmFsc2UsXG4gICAgICAgIG1pbmltYWxMaW5rczogZmFsc2UsXG4gICAgICAgIGRlZmF1bHRMaW5rVGFyZ2V0OiB1bmRlZmluZWQsXG5cbiAgICAgICAgc3ZnUGF0aDogbnVsbFxuICAgIH0sXG4gICAgd3JpdGFibGU6IGZhbHNlLFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiBmYWxzZVxufSk7XG5cbihmdW5jdGlvbiAobmF2aWdhdG9yLCB3aW5kb3csIGRvY3VtZW50LCAkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIENPTkZJUk1fRVZFTlQgPSAndGJ3Y29uZmlybScsXG4gICAgICAgIENBTkNFTF9FVkVOVCA9ICd0YndjYW5jZWwnO1xuXG4gICAgJC5mbi50cnVtYm93eWcgPSBmdW5jdGlvbiAob3B0aW9ucywgcGFyYW1zKSB7XG4gICAgICAgIHZhciB0cnVtYm93eWdEYXRhTmFtZSA9ICd0cnVtYm93eWcnO1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gT2JqZWN0KG9wdGlvbnMpIHx8ICFvcHRpb25zKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoISQodGhpcykuZGF0YSh0cnVtYm93eWdEYXRhTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5kYXRhKHRydW1ib3d5Z0RhdGFOYW1lLCBuZXcgVHJ1bWJvd3lnKHRoaXMsIG9wdGlvbnMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSAkKHRoaXMpLmRhdGEodHJ1bWJvd3lnRGF0YU5hbWUpO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAob3B0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICAvLyBFeGVjIGNvbW1hbmRcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXhlY0NtZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5leGVjQ21kKHBhcmFtcy5jbWQsIHBhcmFtcy5wYXJhbSwgcGFyYW1zLmZvcmNlQ3NzLCBwYXJhbXMuc2tpcFRydW1ib3d5Zyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gTW9kYWwgYm94XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ29wZW5Nb2RhbCc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5vcGVuTW9kYWwocGFyYW1zLnRpdGxlLCBwYXJhbXMuY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Nsb3NlTW9kYWwnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuY2xvc2VNb2RhbCgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdvcGVuTW9kYWxJbnNlcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQub3Blbk1vZGFsSW5zZXJ0KHBhcmFtcy50aXRsZSwgcGFyYW1zLmZpZWxkcywgcGFyYW1zLmNhbGxiYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSYW5nZVxuICAgICAgICAgICAgICAgICAgICBjYXNlICdzYXZlUmFuZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuc2F2ZVJhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dldFJhbmdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnJhbmdlO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdnZXRSYW5nZVRleHQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuZ2V0UmFuZ2VUZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Jlc3RvcmVSYW5nZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5yZXN0b3JlUmFuZ2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBFbmFibGUvZGlzYWJsZVxuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbmFibGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuc2V0RGlzYWJsZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdkaXNhYmxlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnNldERpc2FibGVkKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRvZ2dsZVxuICAgICAgICAgICAgICAgICAgICBjYXNlICd0b2dnbGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQudG9nZ2xlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRGVzdHJveVxuICAgICAgICAgICAgICAgICAgICBjYXNlICdkZXN0cm95JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmRlc3Ryb3koKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBFbXB0eVxuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbXB0eSc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5lbXB0eSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEhUTUxcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaHRtbCc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5odG1sKHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoYykge1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICAvLyBAcGFyYW06IGVkaXRvckVsZW0gaXMgdGhlIERPTSBlbGVtZW50XG4gICAgdmFyIFRydW1ib3d5ZyA9IGZ1bmN0aW9uIChlZGl0b3JFbGVtLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgIHRydW1ib3d5Z0ljb25zSWQgPSAndHJ1bWJvd3lnLWljb25zJyxcbiAgICAgICAgICAgICR0cnVtYm93eWcgPSAkLnRydW1ib3d5ZztcblxuICAgICAgICAvLyBHZXQgdGhlIGRvY3VtZW50IG9mIHRoZSBlbGVtZW50LiBJdCB1c2UgdG8gbWFrZXMgdGhlIHBsdWdpblxuICAgICAgICAvLyBjb21wYXRpYmxlIG9uIGlmcmFtZXMuXG4gICAgICAgIHQuZG9jID0gZWRpdG9yRWxlbS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50O1xuXG4gICAgICAgIC8vIGpRdWVyeSBvYmplY3Qgb2YgdGhlIGVkaXRvclxuICAgICAgICB0LiR0YSA9ICQoZWRpdG9yRWxlbSk7IC8vICR0YSA6IFRleHRhcmVhXG4gICAgICAgIHQuJGMgPSAkKGVkaXRvckVsZW0pOyAvLyAkYyA6IGNyZWF0b3JcblxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgICAvLyBMb2NhbGl6YXRpb24gbWFuYWdlbWVudFxuICAgICAgICBpZiAob3B0aW9ucy5sYW5nICE9IG51bGwgfHwgJHRydW1ib3d5Zy5sYW5nc1tvcHRpb25zLmxhbmddICE9IG51bGwpIHtcbiAgICAgICAgICAgIHQubGFuZyA9ICQuZXh0ZW5kKHRydWUsIHt9LCAkdHJ1bWJvd3lnLmxhbmdzLmVuLCAkdHJ1bWJvd3lnLmxhbmdzW29wdGlvbnMubGFuZ10pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdC5sYW5nID0gJHRydW1ib3d5Zy5sYW5ncy5lbjtcbiAgICAgICAgfVxuXG4gICAgICAgIHQuaGlkZUJ1dHRvblRleHRzID0gJHRydW1ib3d5Zy5oaWRlQnV0dG9uVGV4dHMgIT0gbnVsbCA/ICR0cnVtYm93eWcuaGlkZUJ1dHRvblRleHRzIDogb3B0aW9ucy5oaWRlQnV0dG9uVGV4dHM7XG5cbiAgICAgICAgLy8gU1ZHIHBhdGhcbiAgICAgICAgdmFyIHN2Z1BhdGhPcHRpb24gPSAkdHJ1bWJvd3lnLnN2Z1BhdGggIT0gbnVsbCA/ICR0cnVtYm93eWcuc3ZnUGF0aCA6IG9wdGlvbnMuc3ZnUGF0aDtcbiAgICAgICAgdC5oYXNTdmcgPSBzdmdQYXRoT3B0aW9uICE9PSBmYWxzZTtcblxuICAgICAgICBpZiAoc3ZnUGF0aE9wdGlvbiAhPT0gZmFsc2UgJiYgKCR0cnVtYm93eWcuc3ZnQWJzb2x1dGVVc2VIcmVmIHx8ICQoJyMnICsgdHJ1bWJvd3lnSWNvbnNJZCwgdC5kb2MpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgICAgIGlmIChzdmdQYXRoT3B0aW9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBIYWNrIHRvIGdldCBzdmdQYXRoT3B0aW9uIGJhc2VkIG9uIHRydW1ib3d5Zy5qcyBwYXRoXG4gICAgICAgICAgICAgICAgdmFyICRzY3JpcHRFbGVtZW50cyA9ICQoJ3NjcmlwdFtzcmNdJyk7XG4gICAgICAgICAgICAgICAgJHNjcmlwdEVsZW1lbnRzLmVhY2goZnVuY3Rpb24gKGksIHNjcmlwdEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IHNjcmlwdEVsZW1lbnQuc3JjO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IHNvdXJjZS5tYXRjaCgndHJ1bWJvd3lnKFxcLm1pbik/XFwuanMnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ZnUGF0aE9wdGlvbiA9IHNvdXJjZS5zdWJzdHJpbmcoMCwgc291cmNlLmluZGV4T2YobWF0Y2hlc1swXSkpICsgJ3VpL2ljb25zLnN2Zyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRG8gbm90IG1lcmdlIHdpdGggcHJldmlvdXMgaWYgYmxvY2s6IHN2Z1BhdGhPcHRpb24gY2FuIGJlIHJlZGVmaW5lZCBpbiBpdC5cbiAgICAgICAgICAgIC8vIEhlcmUgd2UgYXJlIGNoZWNraW5nIHRoYXQgd2UgZmluZCBhIG1hdGNoXG4gICAgICAgICAgICBpZiAoc3ZnUGF0aE9wdGlvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdZb3UgbXVzdCBkZWZpbmUgc3ZnUGF0aDogaHR0cHM6Ly9nb28uZ2wvQ2ZUWTlVJyk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxuICAgICAgICAgICAgfSBlbHNlIGlmICghJHRydW1ib3d5Zy5zdmdBYnNvbHV0ZVVzZUhyZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gdC5kb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgZGl2LmlkID0gdHJ1bWJvd3lnSWNvbnNJZDtcbiAgICAgICAgICAgICAgICB0LmRvYy5ib2R5Lmluc2VydEJlZm9yZShkaXYsIHQuZG9jLmJvZHkuY2hpbGROb2Rlc1swXSk7XG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAneG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY3Jvc3NEb21haW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogc3ZnUGF0aE9wdGlvbixcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlU2VuZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gbmV3IFhNTFNlcmlhbGl6ZXIoKS5zZXJpYWxpemVUb1N0cmluZyhkYXRhLmRvY3VtZW50RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBiYXNlSHJlZiA9ICEhdC5kb2MucXVlcnlTZWxlY3RvcignYmFzZScpID8gd2luZG93LmxvY2F0aW9uLmhyZWYuc3BsaXQoL1s/I10vKVswXSA6ICcnO1xuICAgICAgICB0LnN2Z1BhdGggPSAkdHJ1bWJvd3lnLnN2Z0Fic29sdXRlVXNlSHJlZiA/IHN2Z1BhdGhPcHRpb24gOiBiYXNlSHJlZjtcblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGVuIHRoZSBidXR0b24gaXMgYXNzb2NpYXRlZCB0byBhIGVtcHR5IG9iamVjdFxuICAgICAgICAgKiBmbiBhbmQgdGl0bGUgYXR0cmlidXRlcyBhcmUgZGVmaW5lZCBmcm9tIHRoZSBidXR0b24ga2V5IHZhbHVlXG4gICAgICAgICAqXG4gICAgICAgICAqIEZvciBleGFtcGxlXG4gICAgICAgICAqICAgICAgZm9vOiB7fVxuICAgICAgICAgKiBpcyBlcXVpdmFsZW50IHRvIDpcbiAgICAgICAgICogICAgICBmb286IHtcbiAgICAgICAgICogICAgICAgICAgZm46ICdmb28nLFxuICAgICAgICAgKiAgICAgICAgICB0aXRsZTogdGhpcy5sYW5nLmZvb1xuICAgICAgICAgKiAgICAgIH1cbiAgICAgICAgICovXG4gICAgICAgIHZhciBoID0gdC5sYW5nLmhlYWRlciwgLy8gSGVhZGVyIHRyYW5zbGF0aW9uXG4gICAgICAgICAgICBpc0JsaW5rRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh3aW5kb3cuY2hyb21lIHx8ICh3aW5kb3cuSW50bCAmJiBJbnRsLnY4QnJlYWtJdGVyYXRvcikpICYmICdDU1MnIGluIHdpbmRvdztcbiAgICAgICAgICAgIH07XG4gICAgICAgIHQuYnRuc0RlZiA9IHtcbiAgICAgICAgICAgIHZpZXdIVE1MOiB7XG4gICAgICAgICAgICAgICAgZm46ICd0b2dnbGUnLFxuICAgICAgICAgICAgICAgIGNsYXNzOiAndHJ1bWJvd3lnLW5vdC1kaXNhYmxlJyxcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHVuZG86IHtcbiAgICAgICAgICAgICAgICBpc1N1cHBvcnRlZDogaXNCbGlua0Z1bmN0aW9uLFxuICAgICAgICAgICAgICAgIGtleTogJ1onXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVkbzoge1xuICAgICAgICAgICAgICAgIGlzU3VwcG9ydGVkOiBpc0JsaW5rRnVuY3Rpb24sXG4gICAgICAgICAgICAgICAga2V5OiAnWSdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHA6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2Zvcm1hdEJsb2NrJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJsb2NrcXVvdGU6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2Zvcm1hdEJsb2NrJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGgxOiB7XG4gICAgICAgICAgICAgICAgZm46ICdmb3JtYXRCbG9jaycsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGggKyAnIDEnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaDI6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2Zvcm1hdEJsb2NrJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogaCArICcgMidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoMzoge1xuICAgICAgICAgICAgICAgIGZuOiAnZm9ybWF0QmxvY2snLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBoICsgJyAzJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGg0OiB7XG4gICAgICAgICAgICAgICAgZm46ICdmb3JtYXRCbG9jaycsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGggKyAnIDQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaDU6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2Zvcm1hdEJsb2NrJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogaCArICcgNSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoNjoge1xuICAgICAgICAgICAgICAgIGZuOiAnZm9ybWF0QmxvY2snLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBoICsgJyA2J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1YnNjcmlwdDoge1xuICAgICAgICAgICAgICAgIHRhZzogJ3N1YidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBlcnNjcmlwdDoge1xuICAgICAgICAgICAgICAgIHRhZzogJ3N1cCdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGJvbGQ6IHtcbiAgICAgICAgICAgICAgICBrZXk6ICdCJyxcbiAgICAgICAgICAgICAgICB0YWc6ICdiJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGl0YWxpYzoge1xuICAgICAgICAgICAgICAgIGtleTogJ0knLFxuICAgICAgICAgICAgICAgIHRhZzogJ2knXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdW5kZXJsaW5lOiB7XG4gICAgICAgICAgICAgICAgdGFnOiAndSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdHJpa2V0aHJvdWdoOiB7XG4gICAgICAgICAgICAgICAgdGFnOiAnc3RyaWtlJ1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc3Ryb25nOiB7XG4gICAgICAgICAgICAgICAgZm46ICdib2xkJyxcbiAgICAgICAgICAgICAgICBrZXk6ICdCJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVtOiB7XG4gICAgICAgICAgICAgICAgZm46ICdpdGFsaWMnLFxuICAgICAgICAgICAgICAgIGtleTogJ0knXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVsOiB7XG4gICAgICAgICAgICAgICAgZm46ICdzdHJpa2V0aHJvdWdoJ1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgY3JlYXRlTGluazoge1xuICAgICAgICAgICAgICAgIGtleTogJ0snLFxuICAgICAgICAgICAgICAgIHRhZzogJ2EnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdW5saW5rOiB7fSxcblxuICAgICAgICAgICAgaW5zZXJ0SW1hZ2U6IHt9LFxuXG4gICAgICAgICAgICBqdXN0aWZ5TGVmdDoge1xuICAgICAgICAgICAgICAgIHRhZzogJ2xlZnQnLFxuICAgICAgICAgICAgICAgIGZvcmNlQ3NzOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAganVzdGlmeUNlbnRlcjoge1xuICAgICAgICAgICAgICAgIHRhZzogJ2NlbnRlcicsXG4gICAgICAgICAgICAgICAgZm9yY2VDc3M6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBqdXN0aWZ5UmlnaHQ6IHtcbiAgICAgICAgICAgICAgICB0YWc6ICdyaWdodCcsXG4gICAgICAgICAgICAgICAgZm9yY2VDc3M6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBqdXN0aWZ5RnVsbDoge1xuICAgICAgICAgICAgICAgIHRhZzogJ2p1c3RpZnknLFxuICAgICAgICAgICAgICAgIGZvcmNlQ3NzOiB0cnVlXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB1bm9yZGVyZWRMaXN0OiB7XG4gICAgICAgICAgICAgICAgZm46ICdpbnNlcnRVbm9yZGVyZWRMaXN0JyxcbiAgICAgICAgICAgICAgICB0YWc6ICd1bCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvcmRlcmVkTGlzdDoge1xuICAgICAgICAgICAgICAgIGZuOiAnaW5zZXJ0T3JkZXJlZExpc3QnLFxuICAgICAgICAgICAgICAgIHRhZzogJ29sJ1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgaG9yaXpvbnRhbFJ1bGU6IHtcbiAgICAgICAgICAgICAgICBmbjogJ2luc2VydEhvcml6b250YWxSdWxlJ1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcmVtb3ZlZm9ybWF0OiB7fSxcblxuICAgICAgICAgICAgZnVsbHNjcmVlbjoge1xuICAgICAgICAgICAgICAgIGNsYXNzOiAndHJ1bWJvd3lnLW5vdC1kaXNhYmxlJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsb3NlOiB7XG4gICAgICAgICAgICAgICAgZm46ICdkZXN0cm95JyxcbiAgICAgICAgICAgICAgICBjbGFzczogJ3RydW1ib3d5Zy1ub3QtZGlzYWJsZSdcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vIERyb3Bkb3duc1xuICAgICAgICAgICAgZm9ybWF0dGluZzoge1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duOiBbJ3AnLCAnYmxvY2txdW90ZScsICdoMScsICdoMicsICdoMycsICdoNCddLFxuICAgICAgICAgICAgICAgIGljbzogJ3AnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazoge1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duOiBbJ2NyZWF0ZUxpbmsnLCAndW5saW5rJ11cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBEZWZhdWx0IE9wdGlvbnNcbiAgICAgICAgdC5vID0gJC5leHRlbmQodHJ1ZSwge30sICR0cnVtYm93eWcuZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICBpZiAoIXQuby5oYXNPd25Qcm9wZXJ0eSgnaW1nRGJsQ2xpY2tIYW5kbGVyJykpIHtcbiAgICAgICAgICAgIHQuby5pbWdEYmxDbGlja0hhbmRsZXIgPSB0LmdldERlZmF1bHRJbWdEYmxDbGlja0hhbmRsZXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHQudXJsUHJlZml4ID0gdC5zZXR1cFVybFByZWZpeCgpO1xuXG4gICAgICAgIHQuZGlzYWJsZWQgPSB0Lm8uZGlzYWJsZWQgfHwgKGVkaXRvckVsZW0ubm9kZU5hbWUgPT09ICdURVhUQVJFQScgJiYgZWRpdG9yRWxlbS5kaXNhYmxlZCk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuYnRucykge1xuICAgICAgICAgICAgdC5vLmJ0bnMgPSBvcHRpb25zLmJ0bnM7XG4gICAgICAgIH0gZWxzZSBpZiAoIXQuby5zZW1hbnRpYykge1xuICAgICAgICAgICAgdC5vLmJ0bnNbM10gPSBbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZScsICdzdHJpa2V0aHJvdWdoJ107XG4gICAgICAgIH1cblxuICAgICAgICAkLmVhY2godC5vLmJ0bnNEZWYsIGZ1bmN0aW9uIChidG5OYW1lLCBidG5EZWYpIHtcbiAgICAgICAgICAgIHQuYWRkQnRuRGVmKGJ0bk5hbWUsIGJ0bkRlZik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHB1dCB0aGlzIGhlcmUgaW4gdGhlIGV2ZW50IGl0IHdvdWxkIGJlIG1lcmdlZCBpbiB3aXRoIG9wdGlvbnNcbiAgICAgICAgdC5ldmVudE5hbWVzcGFjZSA9ICd0cnVtYm93eWctZXZlbnQnO1xuXG4gICAgICAgIC8vIEtleWJvYXJkIHNob3J0Y3V0cyBhcmUgbG9hZCBpbiB0aGlzIGFycmF5XG4gICAgICAgIHQua2V5cyA9IFtdO1xuXG4gICAgICAgIC8vIFRhZyB0byBidXR0b24gZHluYW1pY2FsbHkgaHlkcmF0ZWRcbiAgICAgICAgdC50YWdUb0J1dHRvbiA9IHt9O1xuICAgICAgICB0LnRhZ0hhbmRsZXJzID0gW107XG5cbiAgICAgICAgLy8gQWRtaXQgbXVsdGlwbGUgcGFzdGUgaGFuZGxlcnNcbiAgICAgICAgdC5wYXN0ZUhhbmRsZXJzID0gW10uY29uY2F0KHQuby5wYXN0ZUhhbmRsZXJzKTtcblxuICAgICAgICAvLyBDaGVjayBpZiBicm93c2VyIGlzIElFXG4gICAgICAgIHQuaXNJRSA9IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignTVNJRScpICE9PSAtMSB8fCBuYXZpZ2F0b3IuYXBwVmVyc2lvbi5pbmRleE9mKCdUcmlkZW50LycpICE9PSAtMTtcblxuICAgICAgICAvLyBDaGVjayBpZiB3ZSBhcmUgb24gbWFjT3NcbiAgICAgICAgdC5pc01hYyA9IG5hdmlnYXRvci5wbGF0Zm9ybS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoJ01BQycpICE9PSAtMTtcblxuICAgICAgICB0LmluaXQoKTtcbiAgICB9O1xuXG4gICAgVHJ1bWJvd3lnLnByb3RvdHlwZSA9IHtcbiAgICAgICAgREVGQVVMVF9TRU1BTlRJQ19NQVA6IHtcbiAgICAgICAgICAgICdiJzogJ3N0cm9uZycsXG4gICAgICAgICAgICAnaSc6ICdlbScsXG4gICAgICAgICAgICAncyc6ICdkZWwnLFxuICAgICAgICAgICAgJ3N0cmlrZSc6ICdkZWwnLFxuICAgICAgICAgICAgJ2Rpdic6ICdwJ1xuICAgICAgICB9LFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgICAgIHQuaGVpZ2h0ID0gdC4kdGEuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgIHQuaW5pdFBsdWdpbnMoKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBEaXNhYmxlIGltYWdlIHJlc2l6ZSwgdHJ5LWNhdGNoIGZvciBvbGQgSUVcbiAgICAgICAgICAgICAgICB0LmRvYy5leGVjQ29tbWFuZCgnZW5hYmxlT2JqZWN0UmVzaXppbmcnLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHQuZG9jLmV4ZWNDb21tYW5kKCdkZWZhdWx0UGFyYWdyYXBoU2VwYXJhdG9yJywgZmFsc2UsICdwJyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHQuYnVpbGRFZGl0b3IoKTtcbiAgICAgICAgICAgIHQuYnVpbGRCdG5QYW5lKCk7XG5cbiAgICAgICAgICAgIHQuZml4ZWRCdG5QYW5lRXZlbnRzKCk7XG5cbiAgICAgICAgICAgIHQuYnVpbGRPdmVybGF5KCk7XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICh0LmRpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3aW5pdCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRkQnRuRGVmOiBmdW5jdGlvbiAoYnRuTmFtZSwgYnRuRGVmKSB7XG4gICAgICAgICAgICB0aGlzLmJ0bnNEZWZbYnRuTmFtZV0gPSAkLmV4dGVuZChidG5EZWYsIHRoaXMuYnRuc0RlZltidG5OYW1lXSB8fCB7fSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0dXBVcmxQcmVmaXg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwcm90b2NvbCA9IHRoaXMuby51cmxQcm90b2NvbDtcbiAgICAgICAgICAgIGlmICghcHJvdG9jb2wpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgKHByb3RvY29sKSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2h0dHBzOi8vJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwcm90b2NvbC5yZXBsYWNlKCc6Ly8nLCAnJykgKyAnOi8vJztcbiAgICAgICAgfSxcblxuICAgICAgICBidWlsZEVkaXRvcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgaHRtbCA9ICcnO1xuXG4gICAgICAgICAgICB0LiRib3ggPSAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICAgICAgY2xhc3M6IHByZWZpeCArICdib3ggJyArIHByZWZpeCArICdlZGl0b3ItdmlzaWJsZSAnICsgcHJlZml4ICsgdC5vLmxhbmcgKyAnIHRydW1ib3d5ZydcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyAkdGEgPSBUZXh0YXJlYVxuICAgICAgICAgICAgLy8gJGVkID0gRWRpdG9yXG4gICAgICAgICAgICB0LmlzVGV4dGFyZWEgPSB0LiR0YS5pcygndGV4dGFyZWEnKTtcbiAgICAgICAgICAgIGlmICh0LmlzVGV4dGFyZWEpIHtcbiAgICAgICAgICAgICAgICBodG1sID0gdC4kdGEudmFsKCk7XG4gICAgICAgICAgICAgICAgdC4kZWQgPSAkKCc8ZGl2Lz4nKTtcbiAgICAgICAgICAgICAgICB0LiRib3hcbiAgICAgICAgICAgICAgICAgICAgLmluc2VydEFmdGVyKHQuJHRhKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHQuJGVkLCB0LiR0YSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHQuJGVkID0gdC4kdGE7XG4gICAgICAgICAgICAgICAgaHRtbCA9IHQuJGVkLmh0bWwoKTtcblxuICAgICAgICAgICAgICAgIHQuJHRhID0gJCgnPHRleHRhcmVhLz4nLCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHQuJHRhLmF0dHIoJ2lkJyksXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogdC5oZWlnaHRcbiAgICAgICAgICAgICAgICB9KS52YWwoaHRtbCk7XG5cbiAgICAgICAgICAgICAgICB0LiRib3hcbiAgICAgICAgICAgICAgICAgICAgLmluc2VydEFmdGVyKHQuJGVkKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHQuJHRhLCB0LiRlZCk7XG4gICAgICAgICAgICAgICAgdC5zeW5jQ29kZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0LiR0YVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhwcmVmaXggKyAndGV4dGFyZWEnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0YWJpbmRleCcsIC0xKVxuICAgICAgICAgICAgO1xuXG4gICAgICAgICAgICB0LiRlZFxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhwcmVmaXggKyAnZWRpdG9yJylcbiAgICAgICAgICAgICAgICAuYXR0cih7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRlZGl0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZGlyOiB0LmxhbmcuX2RpciB8fCAnbHRyJ1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmh0bWwoaHRtbClcbiAgICAgICAgICAgIDtcblxuICAgICAgICAgICAgaWYgKHQuby50YWJpbmRleCkge1xuICAgICAgICAgICAgICAgIHQuJGVkLmF0dHIoJ3RhYmluZGV4JywgdC5vLnRhYmluZGV4KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHQuJGMuaXMoJ1twbGFjZWhvbGRlcl0nKSkge1xuICAgICAgICAgICAgICAgIHQuJGVkLmF0dHIoJ3BsYWNlaG9sZGVyJywgdC4kYy5hdHRyKCdwbGFjZWhvbGRlcicpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHQuJGMuaXMoJ1tzcGVsbGNoZWNrXScpKSB7XG4gICAgICAgICAgICAgICAgdC4kZWQuYXR0cignc3BlbGxjaGVjaycsIHQuJGMuYXR0cignc3BlbGxjaGVjaycpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHQuby5yZXNldENzcykge1xuICAgICAgICAgICAgICAgIHQuJGVkLmFkZENsYXNzKHByZWZpeCArICdyZXNldC1jc3MnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0Lm8uYXV0b2dyb3cpIHtcbiAgICAgICAgICAgICAgICB0LiR0YS5hZGQodC4kZWQpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogdC5oZWlnaHRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoKTtcblxuICAgICAgICAgICAgaWYgKHQuby5hdXRvZ3Jvd09uRW50ZXIpIHtcbiAgICAgICAgICAgICAgICB0LiRlZC5hZGRDbGFzcyhwcmVmaXggKyAnYXV0b2dyb3ctb24tZW50ZXInKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGN0cmwgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICBjb21wb3NpdGlvbiA9IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRlYm91bmNlQnV0dG9uUGFuZVN0YXR1cztcblxuICAgICAgICAgICAgdC4kZWRcbiAgICAgICAgICAgICAgICAub24oJ2RibGNsaWNrJywgJ2ltZycsIHQuby5pbWdEYmxDbGlja0hhbmRsZXIpXG4gICAgICAgICAgICAgICAgLm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXBwZW5kIGZsYWdzIHRvIGRpZmZlcmVudGlhdGUgQ2hyb21lIHNwYW5zXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZS53aGljaDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleUNvZGUgPT09IDggfHwga2V5Q29kZSA9PT0gMTMgfHwga2V5Q29kZSA9PT0gNDYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQudG9nZ2xlU3Bhbih0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmICFlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3RybCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gdC5rZXlzW1N0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCkudG9VcHBlckNhc2UoKV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjQ21kKGtleS5mbiwga2V5LnBhcmFtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5vLnRhYlRvSW5kZW50ICYmIGUua2V5ID09PSAnVGFiJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWNDbWQoJ291dGRlbnQnLCB0cnVlLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY0NtZCgnaW5kZW50JywgdHJ1ZSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbignY29tcG9zaXRpb25zdGFydCBjb21wb3NpdGlvbnVwZGF0ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKCdrZXl1cCBjb21wb3NpdGlvbmVuZCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdjb21wb3NpdGlvbmVuZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29tcG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZS53aGljaDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5Q29kZSA+PSAzNyAmJiBrZXlDb2RlIDw9IDQwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgQ2hyb21lIGdlbmVyYXRlZCBzcGFuIHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleUNvZGUgPT09IDggfHwga2V5Q29kZSA9PT0gMTMgfHwga2V5Q29kZSA9PT0gNDYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQudG9nZ2xlU3BhbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiAoa2V5Q29kZSA9PT0gODkgfHwga2V5Q29kZSA9PT0gOTApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNlbWFudGljQ29kZShmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFjdHJsICYmIGtleUNvZGUgIT09IDE3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcG9zaXRpb25FbmRJRSA9IHQuaXNJRSA/IGUudHlwZSA9PT0gJ2NvbXBvc2l0aW9uZW5kJyA6IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNlbWFudGljQ29kZShmYWxzZSwgY29tcG9zaXRpb25FbmRJRSAmJiBrZXlDb2RlID09PSAxMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBlLndoaWNoID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoZmFsc2UsIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3RybCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oJ21vdXNldXAga2V5ZG93biBrZXl1cCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoIWUuY3RybEtleSAmJiAhZS5tZXRhS2V5KSB8fCBlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IC8vIFwiaG9sZCBvblwiIHRvIHRoZSBjdHJsIGtleSBmb3IgNTBtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0cmwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoZGVib3VuY2VCdXR0b25QYW5lU3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgZGVib3VuY2VCdXR0b25QYW5lU3RhdHVzID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnVwZGF0ZUJ1dHRvblBhbmVTdGF0dXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKCdmb2N1cyBibHVyJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUudHlwZSA9PT0gJ2JsdXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LmNsZWFyQnV0dG9uUGFuZVN0YXR1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3JyArIGUudHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lm8uYXV0b2dyb3dPbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5hdXRvZ3Jvd09uRW50ZXJEb250Q2xvc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS50eXBlID09PSAnZm9jdXMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hdXRvZ3Jvd09uRW50ZXJXYXNGb2N1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmF1dG9ncm93RWRpdG9yT25FbnRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdC5vLmF1dG9ncm93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC4kZWQuY3NzKHtoZWlnaHQ6IHQuJGVkLmNzcygnbWluLWhlaWdodCcpfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndyZXNpemUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKCdrZXl1cCBmb2N1cycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghdC4kdGEudmFsKCkubWF0Y2goLzwuKj4vKSAmJiAhdC4kZWQuaHRtbCgpLm1hdGNoKC88Lio+LykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBibG9jayA9IHQuaXNJRSA/ICc8cD4nIDogJ3AnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuZG9jLmV4ZWNDb21tYW5kKCdmb3JtYXRCbG9jaycsIGZhbHNlLCBibG9jayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zeW5jQ29kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbignY3V0IGRyb3AnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdC4kYy50cmlnZ2VyKCd0YndjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oJ3Bhc3RlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuby5yZW1vdmVmb3JtYXRQYXN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24gJiYgd2luZG93LmdldFNlbGVjdGlvbigpLmRlbGV0ZUZyb21Eb2N1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5kZWxldGVGcm9tRG9jdW1lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJRVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gd2luZG93LmNsaXBib2FyZERhdGEuZ2V0RGF0YSgnVGV4dCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPD0gSUUxMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmRvYy5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS5wYXN0ZUhUTUwodGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJRSAxMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmRvYy5nZXRTZWxlY3Rpb24oKS5nZXRSYW5nZUF0KDApLmluc2VydE5vZGUodC5kb2MuY3JlYXRlVGV4dE5vZGUodGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBJRVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY0NtZCgnaW5zZXJ0VGV4dCcsIChlLm9yaWdpbmFsRXZlbnQgfHwgZSkuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L3BsYWluJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbCBwYXN0ZUhhbmRsZXJzXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaCh0LnBhc3RlSGFuZGxlcnMsIGZ1bmN0aW9uIChpLCBwYXN0ZUhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3RlSGFuZGxlcihlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNlbWFudGljQ29kZShmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid3Bhc3RlJywgZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdC4kdGFcbiAgICAgICAgICAgICAgICAub24oJ2tleXVwJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKCdwYXN0ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJCh0LmRvYy5ib2R5KS5vbigna2V5ZG93bi4nICsgdC5ldmVudE5hbWVzcGFjZSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS53aGljaCA9PT0gMjcgJiYgJCgnLicgKyBwcmVmaXggKyAnbW9kYWwtYm94JykubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdC5jbG9zZU1vZGFsKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvL2F1dG9ncm93IHdoZW4gZW50ZXJpbmcgbG9naWNcbiAgICAgICAgYXV0b2dyb3dFZGl0b3JPbkVudGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LiRlZC5yZW1vdmVDbGFzcygnYXV0b2dyb3ctb24tZW50ZXInKTtcbiAgICAgICAgICAgIHZhciBvbGRIZWlnaHQgPSB0LiRlZFswXS5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICB0LiRlZC5oZWlnaHQoJ2F1dG8nKTtcbiAgICAgICAgICAgIHZhciB0b3RhbEhlaWdodCA9IHQuJGVkWzBdLnNjcm9sbEhlaWdodDtcbiAgICAgICAgICAgIHQuJGVkLmFkZENsYXNzKCdhdXRvZ3Jvdy1vbi1lbnRlcicpO1xuICAgICAgICAgICAgaWYgKG9sZEhlaWdodCAhPT0gdG90YWxIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0LiRlZC5oZWlnaHQob2xkSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdC4kZWQuY3NzKHtoZWlnaHQ6IHRvdGFsSGVpZ2h0fSk7XG4gICAgICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3cmVzaXplJyk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cblxuICAgICAgICAvLyBCdWlsZCBidXR0b24gcGFuZSwgdXNlIG8uYnRucyBvcHRpb25cbiAgICAgICAgYnVpbGRCdG5QYW5lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeDtcblxuICAgICAgICAgICAgdmFyICRidG5QYW5lID0gdC4kYnRuUGFuZSA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICBjbGFzczogcHJlZml4ICsgJ2J1dHRvbi1wYW5lJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQuZWFjaCh0Lm8uYnRucywgZnVuY3Rpb24gKGksIGJ0bkdycCkge1xuICAgICAgICAgICAgICAgIGlmICghJC5pc0FycmF5KGJ0bkdycCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYnRuR3JwID0gW2J0bkdycF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyICRidG5Hcm91cCA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHByZWZpeCArICdidXR0b24tZ3JvdXAgJyArICgoYnRuR3JwLmluZGV4T2YoJ2Z1bGxzY3JlZW4nKSA+PSAwKSA/IHByZWZpeCArICdyaWdodCcgOiAnJylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkLmVhY2goYnRuR3JwLCBmdW5jdGlvbiAoaSwgYnRuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7IC8vIFByZXZlbnQgYnVpbGRCdG4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmlzU3VwcG9ydGVkQnRuKGJ0bikpIHsgLy8gSXQncyBhIHN1cHBvcnRlZCBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYnRuR3JvdXAuYXBwZW5kKHQuYnVpbGRCdG4oYnRuKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCRidG5Hcm91cC5odG1sKCkudHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgJGJ0blBhbmUuYXBwZW5kKCRidG5Hcm91cCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHQuJGJveC5wcmVwZW5kKCRidG5QYW5lKTtcbiAgICAgICAgfSxcblxuXG4gICAgICAgIC8vIEJ1aWxkIGEgYnV0dG9uIGFuZCBoaXMgYWN0aW9uXG4gICAgICAgIGJ1aWxkQnRuOiBmdW5jdGlvbiAoYnRuTmFtZSkgeyAvLyBidG5OYW1lIGlzIG5hbWUgb2YgdGhlIGJ1dHRvblxuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgYnRuID0gdC5idG5zRGVmW2J0bk5hbWVdLFxuICAgICAgICAgICAgICAgIGlzRHJvcGRvd24gPSBidG4uZHJvcGRvd24sXG4gICAgICAgICAgICAgICAgaGFzSWNvbiA9IGJ0bi5oYXNJY29uICE9IG51bGwgPyBidG4uaGFzSWNvbiA6IHRydWUsXG4gICAgICAgICAgICAgICAgdGV4dERlZiA9IHQubGFuZ1tidG5OYW1lXSB8fCBidG5OYW1lLFxuXG4gICAgICAgICAgICAgICAgJGJ0biA9ICQoJzxidXR0b24vPicsIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiBwcmVmaXggKyBidG5OYW1lICsgJy1idXR0b24gJyArIChidG4uY2xhc3MgfHwgJycpICsgKCFoYXNJY29uID8gJyAnICsgcHJlZml4ICsgJ3RleHR1YWwtYnV0dG9uJyA6ICcnKSxcbiAgICAgICAgICAgICAgICAgICAgaHRtbDogdC5oYXNTdmcgJiYgaGFzSWNvbiA/XG4gICAgICAgICAgICAgICAgICAgICAgICAnPHN2Zz48dXNlIHhsaW5rOmhyZWY9XCInICsgdC5zdmdQYXRoICsgJyMnICsgcHJlZml4ICsgKGJ0bi5pY28gfHwgYnRuTmFtZSkucmVwbGFjZSgvKFtBLVpdKykvZywgJy0kMScpLnRvTG93ZXJDYXNlKCkgKyAnXCIvPjwvc3ZnPicgOlxuICAgICAgICAgICAgICAgICAgICAgICAgdC5oaWRlQnV0dG9uVGV4dHMgPyAnJyA6IChidG4udGV4dCB8fCBidG4udGl0bGUgfHwgdC5sYW5nW2J0bk5hbWVdIHx8IGJ0bk5hbWUpLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogKGJ0bi50aXRsZSB8fCBidG4udGV4dCB8fCB0ZXh0RGVmKSArIChidG4ua2V5ID8gJyAoJyArICh0LmlzTWFjID8gJ0NtZCcgOiAnQ3RybCcpICsgJyArICcgKyBidG4ua2V5ICsgJyknIDogJycpLFxuICAgICAgICAgICAgICAgICAgICB0YWJpbmRleDogLTEsXG4gICAgICAgICAgICAgICAgICAgIG1vdXNlZG93bjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0Ryb3Bkb3duIHx8ICQoJy4nICsgYnRuTmFtZSArICctJyArIHByZWZpeCArICdkcm9wZG93bicsIHQuJGJveCkuaXMoJzpoaWRkZW4nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2JvZHknLCB0LmRvYykudHJpZ2dlcignbW91c2Vkb3duJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodC4kYnRuUGFuZS5oYXNDbGFzcyhwcmVmaXggKyAnZGlzYWJsZScpIHx8IHQuJGJveC5oYXNDbGFzcyhwcmVmaXggKyAnZGlzYWJsZWQnKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhJCh0aGlzKS5oYXNDbGFzcyhwcmVmaXggKyAnYWN0aXZlJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhJCh0aGlzKS5oYXNDbGFzcyhwcmVmaXggKyAnbm90LWRpc2FibGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjQ21kKChpc0Ryb3Bkb3duID8gJ2Ryb3Bkb3duJyA6IGZhbHNlKSB8fCBidG4uZm4gfHwgYnRuTmFtZSwgYnRuLnBhcmFtIHx8IGJ0bk5hbWUsIGJ0bi5mb3JjZUNzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoaXNEcm9wZG93bikge1xuICAgICAgICAgICAgICAgICRidG4uYWRkQ2xhc3MocHJlZml4ICsgJ29wZW4tZHJvcGRvd24nKTtcbiAgICAgICAgICAgICAgICB2YXIgZHJvcGRvd25QcmVmaXggPSBwcmVmaXggKyAnZHJvcGRvd24nLFxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bk9wdGlvbnMgPSB7IC8vIHRoZSBkcm9wZG93blxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IGRyb3Bkb3duUHJlZml4ICsgJy0nICsgYnRuTmFtZSArICcgJyArIGRyb3Bkb3duUHJlZml4ICsgJyAnICsgcHJlZml4ICsgJ2ZpeGVkLXRvcCAnICsgKGJ0bi5kcm9wZG93bkNsYXNzIHx8ICcnKVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duT3B0aW9uc1snZGF0YS0nICsgZHJvcGRvd25QcmVmaXhdID0gYnRuTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgJGRyb3Bkb3duID0gJCgnPGRpdi8+JywgZHJvcGRvd25PcHRpb25zKTtcbiAgICAgICAgICAgICAgICAkLmVhY2goaXNEcm9wZG93biwgZnVuY3Rpb24gKGksIGRlZikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodC5idG5zRGVmW2RlZl0gJiYgdC5pc1N1cHBvcnRlZEJ0bihkZWYpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkZHJvcGRvd24uYXBwZW5kKHQuYnVpbGRTdWJCdG4oZGVmKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0LiRib3guYXBwZW5kKCRkcm9wZG93bi5oaWRlKCkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChidG4ua2V5KSB7XG4gICAgICAgICAgICAgICAgdC5rZXlzW2J0bi5rZXldID0ge1xuICAgICAgICAgICAgICAgICAgICBmbjogYnRuLmZuIHx8IGJ0bk5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtOiBidG4ucGFyYW0gfHwgYnRuTmFtZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghaXNEcm9wZG93bikge1xuICAgICAgICAgICAgICAgIHQudGFnVG9CdXR0b25bKGJ0bi50YWcgfHwgYnRuTmFtZSkudG9Mb3dlckNhc2UoKV0gPSBidG5OYW1lO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gJGJ0bjtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gQnVpbGQgYSBidXR0b24gZm9yIGRyb3Bkb3duIG1lbnVcbiAgICAgICAgLy8gQHBhcmFtIG4gOiBuYW1lIG9mIHRoZSBzdWJidXR0b25cbiAgICAgICAgYnVpbGRTdWJCdG46IGZ1bmN0aW9uIChidG5OYW1lKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeCxcbiAgICAgICAgICAgICAgICBidG4gPSB0LmJ0bnNEZWZbYnRuTmFtZV0sXG4gICAgICAgICAgICAgICAgaGFzSWNvbiA9IGJ0bi5oYXNJY29uICE9IG51bGwgPyBidG4uaGFzSWNvbiA6IHRydWU7XG5cbiAgICAgICAgICAgIGlmIChidG4ua2V5KSB7XG4gICAgICAgICAgICAgICAgdC5rZXlzW2J0bi5rZXldID0ge1xuICAgICAgICAgICAgICAgICAgICBmbjogYnRuLmZuIHx8IGJ0bk5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtOiBidG4ucGFyYW0gfHwgYnRuTmFtZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHQudGFnVG9CdXR0b25bKGJ0bi50YWcgfHwgYnRuTmFtZSkudG9Mb3dlckNhc2UoKV0gPSBidG5OYW1lO1xuXG4gICAgICAgICAgICByZXR1cm4gJCgnPGJ1dHRvbi8+Jywge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgICAgIGNsYXNzOiBwcmVmaXggKyBidG5OYW1lICsgJy1kcm9wZG93bi1idXR0b24gJyArIChidG4uY2xhc3MgfHwgJycpICsgKGJ0bi5pY28gPyAnICcgKyBwcmVmaXggKyBidG4uaWNvICsgJy1idXR0b24nIDogJycpLFxuICAgICAgICAgICAgICAgIGh0bWw6IHQuaGFzU3ZnICYmIGhhc0ljb24gP1xuICAgICAgICAgICAgICAgICAgICAnPHN2Zz48dXNlIHhsaW5rOmhyZWY9XCInICsgdC5zdmdQYXRoICsgJyMnICsgcHJlZml4ICsgKGJ0bi5pY28gfHwgYnRuTmFtZSkucmVwbGFjZSgvKFtBLVpdKykvZywgJy0kMScpLnRvTG93ZXJDYXNlKCkgKyAnXCIvPjwvc3ZnPicgKyAoYnRuLnRleHQgfHwgYnRuLnRpdGxlIHx8IHQubGFuZ1tidG5OYW1lXSB8fCBidG5OYW1lKSA6XG4gICAgICAgICAgICAgICAgICAgIChidG4udGV4dCB8fCBidG4udGl0bGUgfHwgdC5sYW5nW2J0bk5hbWVdIHx8IGJ0bk5hbWUpLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAoYnRuLmtleSA/ICcoJyArICh0LmlzTWFjID8gJ0NtZCcgOiAnQ3RybCcpICsgJyArICcgKyBidG4ua2V5ICsgJyknIDogbnVsbCksXG4gICAgICAgICAgICAgICAgc3R5bGU6IGJ0bi5zdHlsZSB8fCBudWxsLFxuICAgICAgICAgICAgICAgIG1vdXNlZG93bjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkKCdib2R5JywgdC5kb2MpLnRyaWdnZXIoJ21vdXNlZG93bicpO1xuXG4gICAgICAgICAgICAgICAgICAgIHQuZXhlY0NtZChidG4uZm4gfHwgYnRuTmFtZSwgYnRuLnBhcmFtIHx8IGJ0bk5hbWUsIGJ0bi5mb3JjZUNzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICAvLyBDaGVjayBpZiBidXR0b24gaXMgc3VwcG9ydGVkXG4gICAgICAgIGlzU3VwcG9ydGVkQnRuOiBmdW5jdGlvbiAoYnRuTmFtZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5idG5zRGVmW2J0bk5hbWVdLmlzU3VwcG9ydGVkKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBCdWlsZCBvdmVybGF5IGZvciBtb2RhbCBib3hcbiAgICAgICAgYnVpbGRPdmVybGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LiRvdmVybGF5ID0gJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgICAgIGNsYXNzOiB0Lm8ucHJlZml4ICsgJ292ZXJsYXknXG4gICAgICAgICAgICB9KS5hcHBlbmRUbyh0LiRib3gpO1xuICAgICAgICAgICAgcmV0dXJuIHQuJG92ZXJsYXk7XG4gICAgICAgIH0sXG4gICAgICAgIHNob3dPdmVybGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICAkKHdpbmRvdykudHJpZ2dlcignc2Nyb2xsJyk7XG4gICAgICAgICAgICB0LiRvdmVybGF5LmZhZGVJbigyMDApO1xuICAgICAgICAgICAgdC4kYm94LmFkZENsYXNzKHQuby5wcmVmaXggKyAnYm94LWJsdXInKTtcbiAgICAgICAgfSxcbiAgICAgICAgaGlkZU92ZXJsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgICAgIHQuJG92ZXJsYXkuZmFkZU91dCg1MCk7XG4gICAgICAgICAgICB0LiRib3gucmVtb3ZlQ2xhc3ModC5vLnByZWZpeCArICdib3gtYmx1cicpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIE1hbmFnZW1lbnQgb2YgZml4ZWQgYnV0dG9uIHBhbmVcbiAgICAgICAgZml4ZWRCdG5QYW5lRXZlbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgZml4ZWRGdWxsV2lkdGggPSB0Lm8uZml4ZWRGdWxsV2lkdGgsXG4gICAgICAgICAgICAgICAgJGJveCA9IHQuJGJveDtcblxuICAgICAgICAgICAgaWYgKCF0Lm8uZml4ZWRCdG5QYW5lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0LmlzRml4ZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgJCh3aW5kb3cpXG4gICAgICAgICAgICAgICAgLm9uKCdzY3JvbGwuJyArIHQuZXZlbnROYW1lc3BhY2UgKyAnIHJlc2l6ZS4nICsgdC5ldmVudE5hbWVzcGFjZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRib3gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHQuc3luY0NvZGUoKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsVG9wID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gJGJveC5vZmZzZXQoKS50b3AgKyAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvblBhbmUgPSB0LiRidG5QYW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uUGFuZU91dGVySGVpZ2h0ID0gJGJ1dHRvblBhbmUub3V0ZXJIZWlnaHQoKSAtIDI7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKChzY3JvbGxUb3AgLSBvZmZzZXQgPiAwKSAmJiAoKHNjcm9sbFRvcCAtIG9mZnNldCAtIHQuaGVpZ2h0KSA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXQuaXNGaXhlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuaXNGaXhlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvblBhbmUuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogZml4ZWRGdWxsV2lkdGggPyAwIDogJ2F1dG8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LiRib3guY3NzKHtwYWRkaW5nVG9wOiAkYnV0dG9uUGFuZS5oZWlnaHQoKX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvblBhbmUuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogZml4ZWRGdWxsV2lkdGggPyAnMTAwJScgOiAoKCRib3gud2lkdGgoKSAtIDEpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy4nICsgdC5vLnByZWZpeCArICdmaXhlZC10b3AnLCAkYm94KS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZEZ1bGxXaWR0aCA/ICdmaXhlZCcgOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogZml4ZWRGdWxsV2lkdGggPyBidXR0b25QYW5lT3V0ZXJIZWlnaHQgOiBidXR0b25QYW5lT3V0ZXJIZWlnaHQgKyAoc2Nyb2xsVG9wIC0gb2Zmc2V0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6SW5kZXg6IDE1XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmlzRml4ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuaXNGaXhlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvblBhbmUucmVtb3ZlQXR0cignc3R5bGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuJGJveC5jc3Moe3BhZGRpbmdUb3A6IDB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy4nICsgdC5vLnByZWZpeCArICdmaXhlZC10b3AnLCAkYm94KS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogYnV0dG9uUGFuZU91dGVySGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIERpc2FibGUgZWRpdG9yXG4gICAgICAgIHNldERpc2FibGVkOiBmdW5jdGlvbiAoZGlzYWJsZSkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXg7XG5cbiAgICAgICAgICAgIHQuZGlzYWJsZWQgPSBkaXNhYmxlO1xuXG4gICAgICAgICAgICBpZiAoZGlzYWJsZSkge1xuICAgICAgICAgICAgICAgIHQuJHRhLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHQuJHRhLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0LiRib3gudG9nZ2xlQ2xhc3MocHJlZml4ICsgJ2Rpc2FibGVkJywgZGlzYWJsZSk7XG4gICAgICAgICAgICB0LiRlZC5hdHRyKCdjb250ZW50ZWRpdGFibGUnLCAhZGlzYWJsZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gRGVzdHJveSB0aGUgZWRpdG9yXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4O1xuXG4gICAgICAgICAgICBpZiAodC5pc1RleHRhcmVhKSB7XG4gICAgICAgICAgICAgICAgdC4kYm94LmFmdGVyKFxuICAgICAgICAgICAgICAgICAgICB0LiR0YVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNzcyh7aGVpZ2h0OiAnJ30pXG4gICAgICAgICAgICAgICAgICAgICAgICAudmFsKHQuaHRtbCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKHByZWZpeCArICd0ZXh0YXJlYScpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2hvdygpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdC4kYm94LmFmdGVyKFxuICAgICAgICAgICAgICAgICAgICB0LiRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgLmNzcyh7aGVpZ2h0OiAnJ30pXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MocHJlZml4ICsgJ2VkaXRvcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cignY29udGVudGVkaXRhYmxlJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKCdkaXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwodC5odG1sKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2hvdygpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC4kZWQub2ZmKCdkYmxjbGljaycsICdpbWcnKTtcblxuICAgICAgICAgICAgdC5kZXN0cm95UGx1Z2lucygpO1xuXG4gICAgICAgICAgICB0LiRib3gucmVtb3ZlKCk7XG4gICAgICAgICAgICB0LiRjLnJlbW92ZURhdGEoJ3RydW1ib3d5ZycpO1xuICAgICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKHByZWZpeCArICdib2R5LWZ1bGxzY3JlZW4nKTtcbiAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3Y2xvc2UnKTtcbiAgICAgICAgICAgICQod2luZG93KS5vZmYoJ3Njcm9sbC4nICsgdC5ldmVudE5hbWVzcGFjZSArICcgcmVzaXplLicgKyB0LmV2ZW50TmFtZXNwYWNlKTtcbiAgICAgICAgICAgICQodC5kb2MuYm9keSkub2ZmKCdrZXlkb3duLicgKyB0LmV2ZW50TmFtZXNwYWNlKTtcbiAgICAgICAgfSxcblxuXG4gICAgICAgIC8vIEVtcHR5IHRoZSBlZGl0b3JcbiAgICAgICAgZW1wdHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuJHRhLnZhbCgnJyk7XG4gICAgICAgICAgICB0aGlzLnN5bmNDb2RlKHRydWUpO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgLy8gRnVuY3Rpb24gY2FsbCB3aGVuIGNsaWNrIG9uIHZpZXdIVE1MIGJ1dHRvblxuICAgICAgICB0b2dnbGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4O1xuXG4gICAgICAgICAgICBpZiAodC5vLmF1dG9ncm93T25FbnRlcikge1xuICAgICAgICAgICAgICAgIHQuYXV0b2dyb3dPbkVudGVyRG9udENsb3NlID0gIXQuJGJveC5oYXNDbGFzcyhwcmVmaXggKyAnZWRpdG9yLWhpZGRlbicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0LnNlbWFudGljQ29kZShmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0LmRvYy5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICAgICAgICAgICAgICB0LiRib3gudG9nZ2xlQ2xhc3MocHJlZml4ICsgJ2VkaXRvci1oaWRkZW4gJyArIHByZWZpeCArICdlZGl0b3ItdmlzaWJsZScpO1xuICAgICAgICAgICAgICAgIHQuJGJ0blBhbmUudG9nZ2xlQ2xhc3MocHJlZml4ICsgJ2Rpc2FibGUnKTtcbiAgICAgICAgICAgICAgICAkKCcuJyArIHByZWZpeCArICd2aWV3SFRNTC1idXR0b24nLCB0LiRidG5QYW5lKS50b2dnbGVDbGFzcyhwcmVmaXggKyAnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHQuJGJveC5oYXNDbGFzcyhwcmVmaXggKyAnZWRpdG9yLXZpc2libGUnKSkge1xuICAgICAgICAgICAgICAgICAgICB0LiR0YS5hdHRyKCd0YWJpbmRleCcsIC0xKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0LiR0YS5yZW1vdmVBdHRyKCd0YWJpbmRleCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0Lm8uYXV0b2dyb3dPbkVudGVyICYmICF0LmF1dG9ncm93T25FbnRlckRvbnRDbG9zZSkge1xuICAgICAgICAgICAgICAgICAgICB0LmF1dG9ncm93RWRpdG9yT25FbnRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIFJlbW92ZSBvciBhZGQgZmxhZ3MgdG8gc3BhbiB0YWdzIHRvIHJlbW92ZSBDaHJvbWUgZ2VuZXJhdGVkIHNwYW5zXG4gICAgICAgIHRvZ2dsZVNwYW46IGZ1bmN0aW9uIChhZGRGbGFnKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LiRlZC5maW5kKCdzcGFuJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFkZEZsYWcgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCdkYXRhLXRidy1mbGFnJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuYXR0cignZGF0YS10YnctZmxhZycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUF0dHIoJ2RhdGEtdGJ3LWZsYWcnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY29udGVudHMoKS51bndyYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIE9wZW4gZHJvcGRvd24gd2hlbiBjbGljayBvbiBhIGJ1dHRvbiB3aGljaCBvcGVuIHRoYXRcbiAgICAgICAgZHJvcGRvd246IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgJGJvZHkgPSAkKCdib2R5JywgdC5kb2MpLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgJGRyb3Bkb3duID0gJCgnW2RhdGEtJyArIHByZWZpeCArICdkcm9wZG93bj0nICsgbmFtZSArICddJywgdC4kYm94KSxcbiAgICAgICAgICAgICAgICAkYnRuID0gJCgnLicgKyBwcmVmaXggKyBuYW1lICsgJy1idXR0b24nLCB0LiRidG5QYW5lKSxcbiAgICAgICAgICAgICAgICBzaG93ID0gJGRyb3Bkb3duLmlzKCc6aGlkZGVuJyk7XG5cbiAgICAgICAgICAgICRib2R5LnRyaWdnZXIoJ21vdXNlZG93bicpO1xuXG4gICAgICAgICAgICBpZiAoc2hvdykge1xuICAgICAgICAgICAgICAgIHZhciBidG5PZmZzZXRMZWZ0ID0gJGJ0bi5vZmZzZXQoKS5sZWZ0O1xuICAgICAgICAgICAgICAgICRidG4uYWRkQ2xhc3MocHJlZml4ICsgJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICAgICAgJGRyb3Bkb3duLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgICAgICAgICB0b3A6ICRidG4ub2Zmc2V0KCkudG9wIC0gdC4kYnRuUGFuZS5vZmZzZXQoKS50b3AgKyAkYnRuLm91dGVySGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6ICh0Lm8uZml4ZWRGdWxsV2lkdGggJiYgdC5pc0ZpeGVkKSA/IGJ0bk9mZnNldExlZnQgOiAoYnRuT2Zmc2V0TGVmdCAtIHQuJGJ0blBhbmUub2Zmc2V0KCkubGVmdClcbiAgICAgICAgICAgICAgICB9KS5zaG93KCk7XG5cbiAgICAgICAgICAgICAgICAkKHdpbmRvdykudHJpZ2dlcignc2Nyb2xsJyk7XG5cbiAgICAgICAgICAgICAgICAkYm9keS5vbignbW91c2Vkb3duLicgKyB0LmV2ZW50TmFtZXNwYWNlLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRkcm9wZG93bi5pcyhlLnRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy4nICsgcHJlZml4ICsgJ2Ryb3Bkb3duJywgdC4kYm94KS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcuJyArIHByZWZpeCArICdhY3RpdmUnLCB0LiRidG5QYW5lKS5yZW1vdmVDbGFzcyhwcmVmaXggKyAnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkYm9keS5vZmYoJ21vdXNlZG93bi4nICsgdC5ldmVudE5hbWVzcGFjZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuXG4gICAgICAgIC8vIEhUTUwgQ29kZSBtYW5hZ2VtZW50XG4gICAgICAgIGh0bWw6IGZ1bmN0aW9uIChodG1sKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmIChodG1sICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0LiR0YS52YWwoaHRtbCk7XG4gICAgICAgICAgICAgICAgdC5zeW5jQ29kZSh0cnVlKTtcbiAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdC4kdGEudmFsKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHN5bmNUZXh0YXJlYTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgdC4kdGEudmFsKHQuJGVkLnRleHQoKS50cmltKCkubGVuZ3RoID4gMCB8fCB0LiRlZC5maW5kKHQuby50YWdzVG9LZWVwLmpvaW4oJywnKSkubGVuZ3RoID4gMCA/IHQuJGVkLmh0bWwoKSA6ICcnKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3luY0NvZGU6IGZ1bmN0aW9uIChmb3JjZSkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKCFmb3JjZSAmJiB0LiRlZC5pcygnOnZpc2libGUnKSkge1xuICAgICAgICAgICAgICAgIHQuc3luY1RleHRhcmVhKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHdyYXAgdGhlIGNvbnRlbnQgaW4gYSBkaXYgaXQncyBlYXNpZXIgdG8gZ2V0IHRoZSBpbm5lciBodG1sXG4gICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAkKCc8ZGl2PicpLmh0bWwodC4kdGEudmFsKCkpO1xuICAgICAgICAgICAgICAgIC8vIHNjcnViIHRoZSBodG1sIGJlZm9yZSBsb2FkaW5nIGludG8gdGhlIGRvY1xuICAgICAgICAgICAgICAgIHZhciBzYWZlID0gJCgnPGRpdj4nKS5hcHBlbmQoaHRtbCk7XG4gICAgICAgICAgICAgICAgJCh0Lm8udGFnc1RvUmVtb3ZlLmpvaW4oJywnKSwgc2FmZSkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdC4kZWQuaHRtbChzYWZlLmNvbnRlbnRzKCkuaHRtbCgpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHQuby5hdXRvZ3Jvdykge1xuICAgICAgICAgICAgICAgIHQuaGVpZ2h0ID0gdC4kZWQuaGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHQuaGVpZ2h0ICE9PSB0LiR0YS5jc3MoJ2hlaWdodCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuJHRhLmNzcyh7aGVpZ2h0OiB0LmhlaWdodH0pO1xuICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid3Jlc2l6ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0Lm8uYXV0b2dyb3dPbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgdC4kZWQuaGVpZ2h0KCdhdXRvJyk7XG4gICAgICAgICAgICAgICAgdmFyIHRvdGFsSGVpZ2h0ID0gdC5hdXRvZ3Jvd09uRW50ZXJXYXNGb2N1c2VkID8gdC4kZWRbMF0uc2Nyb2xsSGVpZ2h0IDogdC4kZWQuY3NzKCdtaW4taGVpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgaWYgKHRvdGFsSGVpZ2h0ICE9PSB0LiR0YS5jc3MoJ2hlaWdodCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuJGVkLmNzcyh7aGVpZ2h0OiB0b3RhbEhlaWdodH0pO1xuICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid3Jlc2l6ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvLyBBbmFseXNlIGFuZCB1cGRhdGUgdG8gc2VtYW50aWMgY29kZVxuICAgICAgICAvLyBAcGFyYW0gZm9yY2UgOiBmb3JjZSB0byBzeW5jIGNvZGUgZnJvbSB0ZXh0YXJlYVxuICAgICAgICAvLyBAcGFyYW0gZnVsbCAgOiB3cmFwIHRleHQgbm9kZXMgaW4gPHA+XG4gICAgICAgIC8vIEBwYXJhbSBrZWVwUmFuZ2UgIDogbGVhdmUgc2VsZWN0aW9uIHJhbmdlIGFzIGl0IGlzXG4gICAgICAgIHNlbWFudGljQ29kZTogZnVuY3Rpb24gKGZvcmNlLCBmdWxsLCBrZWVwUmFuZ2UpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcbiAgICAgICAgICAgIHQuc2F2ZVJhbmdlKCk7XG4gICAgICAgICAgICB0LnN5bmNDb2RlKGZvcmNlKTtcblxuICAgICAgICAgICAgdmFyIHJlc3RvcmVSYW5nZSA9IHRydWU7XG4gICAgICAgICAgICBpZiAodC5yYW5nZSAmJiB0LnJhbmdlLmNvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgIHJlc3RvcmVSYW5nZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodC5vLnNlbWFudGljKSB7XG4gICAgICAgICAgICAgICAgdC5zZW1hbnRpY1RhZygnYicsIHQuby5zZW1hbnRpY0tlZXBBdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICB0LnNlbWFudGljVGFnKCdpJywgdC5vLnNlbWFudGljS2VlcEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHQuc2VtYW50aWNUYWcoJ3MnLCB0Lm8uc2VtYW50aWNLZWVwQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgdC5zZW1hbnRpY1RhZygnc3RyaWtlJywgdC5vLnNlbWFudGljS2VlcEF0dHJpYnV0ZXMpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZ1bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlubGluZUVsZW1lbnRzU2VsZWN0b3IgPSB0Lm8uaW5saW5lRWxlbWVudHNTZWxlY3RvcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrRWxlbWVudHNTZWxlY3RvciA9ICc6bm90KCcgKyBpbmxpbmVFbGVtZW50c1NlbGVjdG9yICsgJyknO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFdyYXAgdGV4dCBub2RlcyBpbiBzcGFuIGZvciBlYXNpZXIgcHJvY2Vzc2luZ1xuICAgICAgICAgICAgICAgICAgICB0LiRlZC5jb250ZW50cygpLmZpbHRlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ub2RlVHlwZSA9PT0gMyAmJiB0aGlzLm5vZGVWYWx1ZS50cmltKCkubGVuZ3RoID4gMDtcbiAgICAgICAgICAgICAgICAgICAgfSkud3JhcCgnPHNwYW4gZGF0YS10YncvPicpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFdyYXAgZ3JvdXBzIG9mIGlubGluZSBlbGVtZW50cyBpbiBwYXJhZ3JhcGhzIChyZWN1cnNpdmUpXG4gICAgICAgICAgICAgICAgICAgIHZhciB3cmFwSW5saW5lc0luUGFyYWdyYXBoc0Zyb20gPSBmdW5jdGlvbiAoJGZyb20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkZnJvbS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZpbmFsUGFyYWdyYXBoID0gJGZyb20ubmV4dFVudGlsKGJsb2NrRWxlbWVudHNTZWxlY3RvcikuYWRkQmFjaygpLndyYXBBbGwoJzxwLz4nKS5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG5leHRFbGVtZW50ID0gJGZpbmFsUGFyYWdyYXBoLm5leHRBbGwoaW5saW5lRWxlbWVudHNTZWxlY3RvcikuZmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZmluYWxQYXJhZ3JhcGgubmV4dCgnYnInKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cmFwSW5saW5lc0luUGFyYWdyYXBoc0Zyb20oJG5leHRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcElubGluZXNJblBhcmFncmFwaHNGcm9tKHQuJGVkLmNoaWxkcmVuKGlubGluZUVsZW1lbnRzU2VsZWN0b3IpLmZpcnN0KCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIHQuc2VtYW50aWNUYWcoJ2RpdicsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCByaWQgb2YgdGVtcG9yYXJ5IHNwYW4nc1xuICAgICAgICAgICAgICAgICAgICAkKCdbZGF0YS10YnddJywgdC4kZWQpLmNvbnRlbnRzKCkudW53cmFwKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGVtcHR5IDxwPlxuICAgICAgICAgICAgICAgICAgICB0LiRlZC5maW5kKCdwOmVtcHR5JykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFrZWVwUmFuZ2UgJiYgcmVzdG9yZVJhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHQucmVzdG9yZVJhbmdlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdC5zeW5jVGV4dGFyZWEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzZW1hbnRpY1RhZzogZnVuY3Rpb24gKG9sZFRhZywgY29weUF0dHJpYnV0ZXMsIHJldmVydCkge1xuICAgICAgICAgICAgdmFyIG5ld1RhZywgdCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdG1wVGFnID0gb2xkVGFnO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vLnNlbWFudGljICE9IG51bGwgJiYgdHlwZW9mIHRoaXMuby5zZW1hbnRpYyA9PT0gJ29iamVjdCcgJiYgdGhpcy5vLnNlbWFudGljLmhhc093blByb3BlcnR5KG9sZFRhZykpIHtcbiAgICAgICAgICAgICAgICBuZXdUYWcgPSB0aGlzLm8uc2VtYW50aWNbb2xkVGFnXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5vLnNlbWFudGljID09PSB0cnVlICYmIHRoaXMuREVGQVVMVF9TRU1BTlRJQ19NQVAuaGFzT3duUHJvcGVydHkob2xkVGFnKSkge1xuICAgICAgICAgICAgICAgIG5ld1RhZyA9IHRoaXMuREVGQVVMVF9TRU1BTlRJQ19NQVBbb2xkVGFnXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihyZXZlcnQpIHtcbiAgICAgICAgICAgICAgICBvbGRUYWcgPSBuZXdUYWc7XG4gICAgICAgICAgICAgICAgbmV3VGFnID0gdG1wVGFnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKG9sZFRhZywgdGhpcy4kZWQpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZXNldFJhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyICRvbGRUYWcgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmICgkb2xkVGFnLmNvbnRlbnRzKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodC5yYW5nZSAmJiB0LnJhbmdlLnN0YXJ0Q29udGFpbmVyLnBhcmVudE5vZGUgPT09IHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzZXRSYW5nZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciAkbmV3VGFnID0gJCgnPCcgKyBuZXdUYWcgKyAnLz4nKTtcbiAgICAgICAgICAgICAgICAkbmV3VGFnLmluc2VydEJlZm9yZSgkb2xkVGFnKTtcbiAgICAgICAgICAgICAgICBpZiAoY29weUF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCRvbGRUYWcucHJvcCgnYXR0cmlidXRlcycpLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbmV3VGFnLmF0dHIodGhpcy5uYW1lLCB0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRuZXdUYWcuaHRtbCgkb2xkVGFnLmh0bWwoKSk7XG4gICAgICAgICAgICAgICAgJG9sZFRhZy5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBpZihyZXNldFJhbmdlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHQucmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKCRuZXdUYWcuZ2V0KDApKTtcbiAgICAgICAgICAgICAgICAgICAgdC5yYW5nZS5jb2xsYXBzZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gRnVuY3Rpb24gY2FsbCB3aGVuIHVzZXIgY2xpY2sgb24gXCJJbnNlcnQgTGlua1wiXG4gICAgICAgIGNyZWF0ZUxpbms6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBkb2N1bWVudFNlbGVjdGlvbiA9IHQuZG9jLmdldFNlbGVjdGlvbigpLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkUmFuZ2UgPSBkb2N1bWVudFNlbGVjdGlvbi5nZXRSYW5nZUF0KDApLFxuICAgICAgICAgICAgICAgIG5vZGUgPSBkb2N1bWVudFNlbGVjdGlvbi5mb2N1c05vZGUsXG4gICAgICAgICAgICAgICAgdGV4dCA9IG5ldyBYTUxTZXJpYWxpemVyKCkuc2VyaWFsaXplVG9TdHJpbmcoc2VsZWN0ZWRSYW5nZS5jbG9uZUNvbnRlbnRzKCkpIHx8IHNlbGVjdGVkUmFuZ2UgKyAnJyxcbiAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICAgICAgdGFyZ2V0O1xuXG4gICAgICAgICAgICB3aGlsZSAoWydBJywgJ0RJViddLmluZGV4T2Yobm9kZS5ub2RlTmFtZSkgPCAwKSB7XG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5ub2RlTmFtZSA9PT0gJ0EnKSB7XG4gICAgICAgICAgICAgICAgdmFyICRhID0gJChub2RlKTtcbiAgICAgICAgICAgICAgICB0ZXh0ID0gJGEudGV4dCgpO1xuICAgICAgICAgICAgICAgIHVybCA9ICRhLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgICAgICBpZiAoIXQuby5taW5pbWFsTGlua3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAkYS5hdHRyKCd0aXRsZScpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSAkYS5hdHRyKCd0YXJnZXQnKSB8fCB0Lm8uZGVmYXVsdExpbmtUYXJnZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHQuZG9jLmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudFNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudFNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHQuc2F2ZVJhbmdlKCk7XG5cbiAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogdC5sYW5nLmxpbmtVcmwgfHwgJ1VSTCcsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdXJsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0ZXh0OiB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0LmxhbmcudGV4dCxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRleHRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKCF0Lm8ubWluaW1hbExpbmtzKSB7XG4gICAgICAgICAgICAgICAgJC5leHRlbmQob3B0aW9ucywge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHQubGFuZy50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aXRsZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0LmxhbmcudGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRhcmdldFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHQub3Blbk1vZGFsSW5zZXJ0KHQubGFuZy5jcmVhdGVMaW5rLCBvcHRpb25zLCBmdW5jdGlvbiAodikgeyAvLyB2IGlzIHZhbHVlXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHQucHJlcGVuZFVybFByZWZpeCh2LnVybCk7XG4gICAgICAgICAgICAgICAgaWYgKCF1cmwubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbGluayA9ICQoWyc8YSBocmVmPVwiJywgdXJsLCAnXCI+Jywgdi50ZXh0IHx8IHYudXJsLCAnPC9hPiddLmpvaW4oJycpKTtcblxuICAgICAgICAgICAgICAgIGlmICh2LnRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuYXR0cigndGl0bGUnLCB2LnRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHYudGFyZ2V0IHx8IHQuby5kZWZhdWx0TGlua1RhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmF0dHIoJ3RhcmdldCcsIHYudGFyZ2V0IHx8IHQuby5kZWZhdWx0TGlua1RhcmdldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHQucmFuZ2UuZGVsZXRlQ29udGVudHMoKTtcbiAgICAgICAgICAgICAgICB0LnJhbmdlLmluc2VydE5vZGUobGlua1swXSk7XG4gICAgICAgICAgICAgICAgdC5zeW5jQ29kZSgpO1xuICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3Y2hhbmdlJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgcHJlcGVuZFVybFByZWZpeDogZnVuY3Rpb24gKHVybCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKCF0LnVybFByZWZpeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBWQUxJRF9MSU5LX1BSRUZJWCA9IC9eKFthLXpdWy0rLmEtejAtOV0qOnxcXC98IykvaTtcbiAgICAgICAgICAgIGlmIChWQUxJRF9MSU5LX1BSRUZJWC50ZXN0KHVybCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgU0lNUExFX0VNQUlMX1JFR0VYID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XG4gICAgICAgICAgICBpZiAoU0lNUExFX0VNQUlMX1JFR0VYLnRlc3QodXJsKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnbWFpbHRvOicgKyB1cmw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0LnVybFByZWZpeCArIHVybDtcbiAgICAgICAgfSxcbiAgICAgICAgdW5saW5rOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRTZWxlY3Rpb24gPSB0LmRvYy5nZXRTZWxlY3Rpb24oKSxcbiAgICAgICAgICAgICAgICBub2RlID0gZG9jdW1lbnRTZWxlY3Rpb24uZm9jdXNOb2RlO1xuXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRTZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAoWydBJywgJ0RJViddLmluZGV4T2Yobm9kZS5ub2RlTmFtZSkgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5ub2RlTmFtZSA9PT0gJ0EnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHQuZG9jLmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudFNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdC5leGVjQ21kKCd1bmxpbmsnLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGluc2VydEltYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LnNhdmVSYW5nZSgpO1xuXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdVUkwnLFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYWx0OiB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0LmxhbmcuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LmdldFJhbmdlVGV4dCgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHQuby5pbWFnZVdpZHRoTW9kYWxFZGl0KSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy53aWR0aCA9IHt9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0Lm9wZW5Nb2RhbEluc2VydCh0LmxhbmcuaW5zZXJ0SW1hZ2UsIG9wdGlvbnMsIGZ1bmN0aW9uICh2KSB7IC8vIHYgYXJlIHZhbHVlc1xuICAgICAgICAgICAgICAgIHQuZXhlY0NtZCgnaW5zZXJ0SW1hZ2UnLCB2LnVybCwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgIHZhciAkaW1nID0gJCgnaW1nW3NyYz1cIicgKyB2LnVybCArICdcIl06bm90KFthbHRdKScsIHQuJGJveCk7XG4gICAgICAgICAgICAgICAgJGltZy5hdHRyKCdhbHQnLCB2LmFsdCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodC5vLmltYWdlV2lkdGhNb2RhbEVkaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgJGltZy5hdHRyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB2LndpZHRoXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHQuc3luY0NvZGUoKTtcbiAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgZnVsbHNjcmVlbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlbkNzc0NsYXNzID0gcHJlZml4ICsgJ2Z1bGxzY3JlZW4nLFxuICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW5QbGFjZWhvbGRlckNsYXNzID0gZnVsbHNjcmVlbkNzc0NsYXNzICsgJy1wbGFjZWhvbGRlcicsXG4gICAgICAgICAgICAgICAgaXNGdWxsc2NyZWVuLFxuICAgICAgICAgICAgICAgIGVkaXRvckhlaWdodCA9IHQuJGJveC5vdXRlckhlaWdodCgpO1xuXG4gICAgICAgICAgICB0LiRib3gudG9nZ2xlQ2xhc3MoZnVsbHNjcmVlbkNzc0NsYXNzKTtcbiAgICAgICAgICAgIGlzRnVsbHNjcmVlbiA9IHQuJGJveC5oYXNDbGFzcyhmdWxsc2NyZWVuQ3NzQ2xhc3MpO1xuXG4gICAgICAgICAgICBpZiAoaXNGdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgdC4kYm94LmJlZm9yZShcbiAgICAgICAgICAgICAgICAgICAgJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IGZ1bGxzY3JlZW5QbGFjZWhvbGRlckNsYXNzXG4gICAgICAgICAgICAgICAgICAgIH0pLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGVkaXRvckhlaWdodFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICQoJy4nICsgZnVsbHNjcmVlblBsYWNlaG9sZGVyQ2xhc3MpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKCdib2R5JykudG9nZ2xlQ2xhc3MocHJlZml4ICsgJ2JvZHktZnVsbHNjcmVlbicsIGlzRnVsbHNjcmVlbik7XG4gICAgICAgICAgICAkKHdpbmRvdykudHJpZ2dlcignc2Nyb2xsJyk7XG4gICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3RidycgKyAoaXNGdWxsc2NyZWVuID8gJ29wZW4nIDogJ2Nsb3NlJykgKyAnZnVsbHNjcmVlbicpO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgLypcbiAgICAgICAgICogQ2FsbCBtZXRob2Qgb2YgdHJ1bWJvd3lnIGlmIGV4aXN0XG4gICAgICAgICAqIGVsc2UgdHJ5IHRvIGNhbGwgYW5vbnltb3VzIGZ1bmN0aW9uXG4gICAgICAgICAqIGFuZCBmaW5hbGx5IG5hdGl2ZSBleGVjQ29tbWFuZFxuICAgICAgICAgKi9cbiAgICAgICAgZXhlY0NtZDogZnVuY3Rpb24gKGNtZCwgcGFyYW0sIGZvcmNlQ3NzLCBza2lwVHJ1bWJvd3lnKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICBza2lwVHJ1bWJvd3lnID0gISFza2lwVHJ1bWJvd3lnIHx8ICcnO1xuXG4gICAgICAgICAgICBpZiAoY21kICE9PSAnZHJvcGRvd24nKSB7XG4gICAgICAgICAgICAgICAgdC4kZWQuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoY21kID09PSAnc3RyaWtldGhyb3VnaCcgJiYgdC5vLnNlbWFudGljKSB7XG4gICAgICAgICAgICAgICAgdC5zZW1hbnRpY1RhZygnc3RyaWtlJywgdC5vLnNlbWFudGljS2VlcEF0dHJpYnV0ZXMsIHRydWUpOyAvLyBicm93c2VycyBjYW5ub3QgdW5kbyBlLmcuIDxkZWw+IGFzIHRoZXkgZXhwZWN0IDxzdHJpa2U+XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdC5kb2MuZXhlY0NvbW1hbmQoJ3N0eWxlV2l0aENTUycsIGZhbHNlLCBmb3JjZUNzcyB8fCBmYWxzZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChjKSB7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdFtjbWQgKyBza2lwVHJ1bWJvd3lnXShwYXJhbSk7XG4gICAgICAgICAgICB9IGNhdGNoIChjKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY21kKHBhcmFtKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlMikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY21kID09PSAnaW5zZXJ0SG9yaXpvbnRhbFJ1bGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjbWQgPT09ICdmb3JtYXRCbG9jaycgJiYgdC5pc0lFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbSA9ICc8JyArIHBhcmFtICsgJz4nO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdC5kb2MuZXhlY0NvbW1hbmQoY21kLCBmYWxzZSwgcGFyYW0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHQuc3luY0NvZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdC5zZW1hbnRpY0NvZGUoZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3RJZCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5mb2N1c05vZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZighJCh3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZm9jdXNOb2RlLnBhcmVudE5vZGUpLmhhc0NsYXNzKCd0cnVtYm93eWctZWRpdG9yJykpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RJZCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5mb2N1c05vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGFzc2VzID0gdC5vLnRhZ0NsYXNzZXNbcGFyYW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGxpc3RJZCkuYWRkQ2xhc3MoY2xhc3Nlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoY21kICE9PSAnZHJvcGRvd24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHQudXBkYXRlQnV0dG9uUGFuZVN0YXR1cygpO1xuICAgICAgICAgICAgICAgICAgICB0LiRjLnRyaWdnZXIoJ3Rid2NoYW5nZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuXG4gICAgICAgIC8vIE9wZW4gYSBtb2RhbCBib3hcbiAgICAgICAgb3Blbk1vZGFsOiBmdW5jdGlvbiAodGl0bGUsIGNvbnRlbnQsIGJ1aWxkRm9ybSkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXg7XG5cbiAgICAgICAgICAgIGJ1aWxkRm9ybSA9IGJ1aWxkRm9ybSAhPT0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIE5vIG9wZW4gYSBtb2RhbCBib3ggd2hlbiBleGlzdCBvdGhlciBtb2RhbCBib3hcbiAgICAgICAgICAgIGlmICgkKCcuJyArIHByZWZpeCArICdtb2RhbC1ib3gnLCB0LiRib3gpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodC5vLmF1dG9ncm93T25FbnRlcikge1xuICAgICAgICAgICAgICAgIHQuYXV0b2dyb3dPbkVudGVyRG9udENsb3NlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdC5zYXZlUmFuZ2UoKTtcbiAgICAgICAgICAgIHQuc2hvd092ZXJsYXkoKTtcblxuICAgICAgICAgICAgLy8gRGlzYWJsZSBhbGwgYnRuUGFuZSBidG5zXG4gICAgICAgICAgICB0LiRidG5QYW5lLmFkZENsYXNzKHByZWZpeCArICdkaXNhYmxlJyk7XG5cbiAgICAgICAgICAgIC8vIEJ1aWxkIG91dCBvZiBNb2RhbEJveCwgaXQncyB0aGUgbWFzayBmb3IgYW5pbWF0aW9uc1xuICAgICAgICAgICAgdmFyICRtb2RhbCA9ICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgICAgICBjbGFzczogcHJlZml4ICsgJ21vZGFsICcgKyBwcmVmaXggKyAnZml4ZWQtdG9wJ1xuICAgICAgICAgICAgfSkuY3NzKHtcbiAgICAgICAgICAgICAgICB0b3A6IHQuJGJveC5vZmZzZXQoKS50b3AgKyB0LiRidG5QYW5lLmhlaWdodCgpLFxuICAgICAgICAgICAgICAgIHpJbmRleDogOTk5OTlcbiAgICAgICAgICAgIH0pLmFwcGVuZFRvKCQodC5kb2MuYm9keSkpO1xuXG4gICAgICAgICAgICAvLyBDbGljayBvbiBvdmVybGF5IGNsb3NlIG1vZGFsIGJ5IGNhbmNlbGxpbmcgdGhlbVxuICAgICAgICAgICAgdC4kb3ZlcmxheS5vbmUoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRtb2RhbC50cmlnZ2VyKENBTkNFTF9FVkVOVCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEJ1aWxkIHRoZSBmb3JtXG4gICAgICAgICAgICB2YXIgZm9ybU9yQ29udGVudDtcbiAgICAgICAgICAgIGlmIChidWlsZEZvcm0pIHtcbiAgICAgICAgICAgICAgICBmb3JtT3JDb250ZW50ID0gJCgnPGZvcm0vPicsIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgaHRtbDogY29udGVudFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbignc3VibWl0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJG1vZGFsLnRyaWdnZXIoQ09ORklSTV9FVkVOVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbigncmVzZXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbW9kYWwudHJpZ2dlcihDQU5DRUxfRVZFTlQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oJ3N1Ym1pdCByZXNldCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0Lm8uYXV0b2dyb3dPbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hdXRvZ3Jvd09uRW50ZXJEb250Q2xvc2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvcm1PckNvbnRlbnQgPSBjb250ZW50O1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIC8vIEJ1aWxkIE1vZGFsQm94IGFuZCBhbmltYXRlIHRvIHNob3cgdGhlbVxuICAgICAgICAgICAgdmFyICRib3ggPSAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICAgICAgY2xhc3M6IHByZWZpeCArICdtb2RhbC1ib3gnLFxuICAgICAgICAgICAgICAgIGh0bWw6IGZvcm1PckNvbnRlbnRcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIHRvcDogJy0nICsgdC4kYnRuUGFuZS5vdXRlckhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nQm90dG9tOiBidWlsZEZvcm0gPyBudWxsIDogJzUlJyxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hcHBlbmRUbygkbW9kYWwpXG4gICAgICAgICAgICAgICAgLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDFcbiAgICAgICAgICAgICAgICB9LCAxMDApO1xuXG5cbiAgICAgICAgICAgIC8vIEFwcGVuZCB0aXRsZVxuICAgICAgICAgICAgaWYgKHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgJCgnPHNwYW4vPicsIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiBwcmVmaXggKyAnbW9kYWwtdGl0bGUnXG4gICAgICAgICAgICAgICAgfSkucHJlcGVuZFRvKCRib3gpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYnVpbGRGb3JtKSB7XG4gICAgICAgICAgICAgICAgLy8gRm9jdXMgaW4gbW9kYWwgYm94XG4gICAgICAgICAgICAgICAgJCgnOmlucHV0OmZpcnN0JywgJGJveCkuZm9jdXMoKTtcblxuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCBDb25maXJtIGFuZCBDYW5jZWwgYnV0dG9uc1xuICAgICAgICAgICAgICAgIHQuYnVpbGRNb2RhbEJ0bignc3VibWl0JywgJGJveCk7XG4gICAgICAgICAgICAgICAgdC5idWlsZE1vZGFsQnRuKCdyZXNldCcsICRib3gpO1xuXG4gICAgICAgICAgICAgICAgJG1vZGFsLmhlaWdodCgkYm94Lm91dGVySGVpZ2h0KCkgKyAxMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQod2luZG93KS50cmlnZ2VyKCdzY3JvbGwnKTtcbiAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3bW9kYWxvcGVuJyk7XG5cbiAgICAgICAgICAgIHJldHVybiAkbW9kYWw7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIEBwYXJhbSBuIGlzIG5hbWUgb2YgbW9kYWxcbiAgICAgICAgYnVpbGRNb2RhbEJ0bjogZnVuY3Rpb24gKG4sICRtb2RhbCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXg7XG5cbiAgICAgICAgICAgIHJldHVybiAkKCc8YnV0dG9uLz4nLCB7XG4gICAgICAgICAgICAgICAgY2xhc3M6IHByZWZpeCArICdtb2RhbC1idXR0b24gJyArIHByZWZpeCArICdtb2RhbC0nICsgbixcbiAgICAgICAgICAgICAgICB0eXBlOiBuLFxuICAgICAgICAgICAgICAgIHRleHQ6IHQubGFuZ1tuXSB8fCBuXG4gICAgICAgICAgICB9KS5hcHBlbmRUbygkKCdmb3JtJywgJG1vZGFsKSk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGNsb3NlIGN1cnJlbnQgbW9kYWwgYm94XG4gICAgICAgIGNsb3NlTW9kYWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBwcmVmaXggPSB0Lm8ucHJlZml4O1xuXG4gICAgICAgICAgICB0LiRidG5QYW5lLnJlbW92ZUNsYXNzKHByZWZpeCArICdkaXNhYmxlJyk7XG4gICAgICAgICAgICB0LiRvdmVybGF5Lm9mZigpO1xuXG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBtb2RhbCBib3hcbiAgICAgICAgICAgIHZhciAkbW9kYWxCb3ggPSAkKCcuJyArIHByZWZpeCArICdtb2RhbC1ib3gnLCAkKHQuZG9jLmJvZHkpKTtcblxuICAgICAgICAgICAgJG1vZGFsQm94LmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgIHRvcDogJy0nICsgJG1vZGFsQm94LmhlaWdodCgpXG4gICAgICAgICAgICB9LCAxMDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkbW9kYWxCb3gucGFyZW50KCkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdC5oaWRlT3ZlcmxheSgpO1xuICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3bW9kYWxjbG9zZScpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHQucmVzdG9yZVJhbmdlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIFByZS1mb3JtYXR0ZWQgYnVpbGQgYW5kIG1hbmFnZW1lbnQgbW9kYWxcbiAgICAgICAgb3Blbk1vZGFsSW5zZXJ0OiBmdW5jdGlvbiAodGl0bGUsIGZpZWxkcywgY21kKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gdC5vLnByZWZpeCxcbiAgICAgICAgICAgICAgICBsZyA9IHQubGFuZyxcbiAgICAgICAgICAgICAgICBodG1sID0gJycsXG4gICAgICAgICAgICAgICAgaWRQcmVmaXggPSBwcmVmaXggKyAnZm9ybS0nICsgRGF0ZS5ub3coKSArICctJztcblxuICAgICAgICAgICAgJC5lYWNoKGZpZWxkcywgZnVuY3Rpb24gKGZpZWxkTmFtZSwgZmllbGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IGZpZWxkLmxhYmVsIHx8IGZpZWxkTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbiA9IGZpZWxkLm5hbWUgfHwgZmllbGROYW1lLFxuICAgICAgICAgICAgICAgICAgICBhID0gZmllbGQuYXR0cmlidXRlcyB8fCB7fSxcbiAgICAgICAgICAgICAgICAgICAgZmllbGRJZCA9IGlkUHJlZml4ICsgZmllbGROYW1lO1xuXG4gICAgICAgICAgICAgICAgdmFyIGF0dHIgPSBPYmplY3Qua2V5cyhhKS5tYXAoZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb3AgKyAnPVwiJyArIGFbcHJvcF0gKyAnXCInO1xuICAgICAgICAgICAgICAgIH0pLmpvaW4oJyAnKTtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGQudHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgaWYgKCFmaWVsZC5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLm5hbWUgPSBuO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgaHRtbCArPSBmaWVsZC50eXBlKGZpZWxkLCBmaWVsZElkLCBwcmVmaXgsIGxnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIicgKyBwcmVmaXggKyAnaW5wdXQtcm93XCI+JyArXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiJyArIHByZWZpeCArICdpbnB1dC1pbmZvc1wiPjxsYWJlbCBmb3I9XCInICsgZmllbGRJZCArICdcIj48c3Bhbj4nICsgKGxnW2xdID8gbGdbbF0gOiBsKSArICc8L3NwYW4+PC9sYWJlbD48L2Rpdj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCInICsgcHJlZml4ICsgJ2lucHV0LWh0bWxcIj48aW5wdXQgaWQ9XCInICsgZmllbGRJZCArICdcIiB0eXBlPVwiJyArIChmaWVsZC50eXBlIHx8ICd0ZXh0JykgKyAnXCIgbmFtZT1cIicgKyBuICsgJ1wiICcgKyBhdHRyO1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9IChmaWVsZC50eXBlID09PSAnY2hlY2tib3gnICYmIGZpZWxkLnZhbHVlID8gJyBjaGVja2VkPVwiY2hlY2tlZFwiJyA6ICcnKSArICcgdmFsdWU9XCInICsgKGZpZWxkLnZhbHVlIHx8ICcnKS5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JykgKyAnXCI+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB0Lm9wZW5Nb2RhbCh0aXRsZSwgaHRtbClcbiAgICAgICAgICAgICAgICAub24oQ09ORklSTV9FVkVOVCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGZvcm0gPSAkKCdmb3JtJywgJCh0aGlzKSksXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goZmllbGRzLCBmdW5jdGlvbiAoZmllbGROYW1lLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBmaWVsZC5uYW1lIHx8IGZpZWxkTmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmaWVsZCA9ICQoJzppbnB1dFtuYW1lPVwiJyArIG4gKyAnXCJdJywgJGZvcm0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9ICRmaWVsZFswXS50eXBlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGlucHV0VHlwZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2hlY2tib3gnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbbl0gPSAkZmllbGQuaXMoJzpjaGVja2VkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JhZGlvJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW25dID0gJGZpZWxkLmZpbHRlcignOmNoZWNrZWQnKS52YWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW25dID0gJC50cmltKCRmaWVsZC52YWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZC5yZXF1aXJlZCAmJiB2YWx1ZXNbbl0gPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmFkZEVycm9yT25Nb2RhbEZpZWxkKCRmaWVsZCwgdC5sYW5nLnJlcXVpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmllbGQucGF0dGVybiAmJiAhZmllbGQucGF0dGVybi50ZXN0KHZhbHVlc1tuXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYWRkRXJyb3JPbk1vZGFsRmllbGQoJGZpZWxkLCBmaWVsZC5wYXR0ZXJuRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucmVzdG9yZVJhbmdlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbWQodmFsdWVzLCBmaWVsZHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zeW5jQ29kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuJGMudHJpZ2dlcigndGJ3Y2hhbmdlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5jbG9zZU1vZGFsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5vZmYoQ09ORklSTV9FVkVOVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbmUoQ0FOQ0VMX0VWRU5ULCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykub2ZmKENPTkZJUk1fRVZFTlQpO1xuICAgICAgICAgICAgICAgICAgICB0LmNsb3NlTW9kYWwoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkRXJyb3JPbk1vZGFsRmllbGQ6IGZ1bmN0aW9uICgkZmllbGQsIGVycikge1xuICAgICAgICAgICAgdmFyIHByZWZpeCA9IHRoaXMuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgc3BhbkVycm9yQ2xhc3MgPSBwcmVmaXggKyAnbXNnLWVycm9yJyxcbiAgICAgICAgICAgICAgICAkcm93ID0gJGZpZWxkLmNsb3Nlc3QoJy4nICsgcHJlZml4ICsgJ2lucHV0LXJvdycpO1xuXG4gICAgICAgICAgICAkZmllbGRcbiAgICAgICAgICAgICAgICAub24oJ2NoYW5nZSBrZXl1cCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvdy5yZW1vdmVDbGFzcyhwcmVmaXggKyAnaW5wdXQtZXJyb3InKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm93LmZpbmQoJy4nICsgc3BhbkVycm9yQ2xhc3MpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LCAxNTApO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkcm93XG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKHByZWZpeCArICdpbnB1dC1lcnJvcicpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy4nICsgcHJlZml4ICsgJ2lucHV0LWluZm9zIGxhYmVsJylcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAkKCc8c3Bhbi8+Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHNwYW5FcnJvckNsYXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogZXJyXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXREZWZhdWx0SW1nRGJsQ2xpY2tIYW5kbGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyICRpbWcgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBzcmMgPSAkaW1nLmF0dHIoJ3NyYycpLFxuICAgICAgICAgICAgICAgICAgICBiYXNlNjQgPSAnKEJhc2U2NCknO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNyYy5pbmRleE9mKCdkYXRhOmltYWdlJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3JjID0gYmFzZTY0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVVJMJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzcmMsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhbHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0LmxhbmcuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJGltZy5hdHRyKCdhbHQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICh0Lm8uaW1hZ2VXaWR0aE1vZGFsRWRpdCkge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLndpZHRoID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICRpbWcuYXR0cignd2lkdGgnKSA/ICRpbWcuYXR0cignd2lkdGgnKSA6ICcnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdC5vcGVuTW9kYWxJbnNlcnQodC5sYW5nLmluc2VydEltYWdlLCBvcHRpb25zLCBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodi51cmwgIT09IGJhc2U2NCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGltZy5hdHRyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHYudXJsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkaW1nLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWx0OiB2LmFsdFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodC5vLmltYWdlV2lkdGhNb2RhbEVkaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludCh2LndpZHRoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdi53aWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLnJlbW92ZUF0dHIoJ3dpZHRoJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIFJhbmdlIG1hbmFnZW1lbnRcbiAgICAgICAgc2F2ZVJhbmdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRTZWxlY3Rpb24gPSB0LmRvYy5nZXRTZWxlY3Rpb24oKTtcblxuICAgICAgICAgICAgdC5yYW5nZSA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRTZWxlY3Rpb24gfHwgIWRvY3VtZW50U2VsZWN0aW9uLnJhbmdlQ291bnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzYXZlZFJhbmdlID0gdC5yYW5nZSA9IGRvY3VtZW50U2VsZWN0aW9uLmdldFJhbmdlQXQoMCksXG4gICAgICAgICAgICAgICAgcmFuZ2UgPSB0LmRvYy5jcmVhdGVSYW5nZSgpLFxuICAgICAgICAgICAgICAgIHJhbmdlU3RhcnQ7XG4gICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHModC4kZWRbMF0pO1xuICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKHNhdmVkUmFuZ2Uuc3RhcnRDb250YWluZXIsIHNhdmVkUmFuZ2Uuc3RhcnRPZmZzZXQpO1xuICAgICAgICAgICAgcmFuZ2VTdGFydCA9IChyYW5nZSArICcnKS5sZW5ndGg7XG4gICAgICAgICAgICB0Lm1ldGFSYW5nZSA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogcmFuZ2VTdGFydCxcbiAgICAgICAgICAgICAgICBlbmQ6IHJhbmdlU3RhcnQgKyAoc2F2ZWRSYW5nZSArICcnKS5sZW5ndGhcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3RvcmVSYW5nZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIG1ldGFSYW5nZSA9IHQubWV0YVJhbmdlLFxuICAgICAgICAgICAgICAgIHNhdmVkUmFuZ2UgPSB0LnJhbmdlLFxuICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uID0gdC5kb2MuZ2V0U2VsZWN0aW9uKCksXG4gICAgICAgICAgICAgICAgcmFuZ2U7XG5cbiAgICAgICAgICAgIGlmICghc2F2ZWRSYW5nZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG1ldGFSYW5nZSAmJiBtZXRhUmFuZ2Uuc3RhcnQgIT09IG1ldGFSYW5nZS5lbmQpIHsgLy8gQWxnb3JpdGhtIGZyb20gaHR0cDovL2pzZmlkZGxlLm5ldC9XZVd5Ny8zL1xuICAgICAgICAgICAgICAgIHZhciBjaGFySW5kZXggPSAwLFxuICAgICAgICAgICAgICAgICAgICBub2RlU3RhY2sgPSBbdC4kZWRbMF1dLFxuICAgICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAgICBmb3VuZFN0YXJ0ID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHN0b3AgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJhbmdlID0gdC5kb2MuY3JlYXRlUmFuZ2UoKTtcblxuICAgICAgICAgICAgICAgIHdoaWxlICghc3RvcCAmJiAobm9kZSA9IG5vZGVTdGFjay5wb3AoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0Q2hhckluZGV4ID0gY2hhckluZGV4ICsgbm9kZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kU3RhcnQgJiYgbWV0YVJhbmdlLnN0YXJ0ID49IGNoYXJJbmRleCAmJiBtZXRhUmFuZ2Uuc3RhcnQgPD0gbmV4dENoYXJJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KG5vZGUsIG1ldGFSYW5nZS5zdGFydCAtIGNoYXJJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRTdGFydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmRTdGFydCAmJiBtZXRhUmFuZ2UuZW5kID49IGNoYXJJbmRleCAmJiBtZXRhUmFuZ2UuZW5kIDw9IG5leHRDaGFySW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQobm9kZSwgbWV0YVJhbmdlLmVuZCAtIGNoYXJJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFySW5kZXggPSBuZXh0Q2hhckluZGV4O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNuID0gbm9kZS5jaGlsZE5vZGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBjbi5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgLT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlU3RhY2sucHVzaChjbltpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZpeCBJRTExIEVycm9yICdDb3VsZCBub3QgY29tcGxldGUgdGhlIG9wZXJhdGlvbiBkdWUgdG8gZXJyb3IgODAwYTAyNWUnLlxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTYxNjA5OTYvY291bGQtbm90LWNvbXBsZXRlLXRoZS1vcGVyYXRpb24tZHVlLXRvLWVycm9yLTgwMGEwMjVlXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50U2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkb2N1bWVudFNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSB8fCBzYXZlZFJhbmdlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0UmFuZ2VUZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yYW5nZSArICcnO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNsZWFyQnV0dG9uUGFuZVN0YXR1czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgYWN0aXZlQ2xhc3NlcyA9IHByZWZpeCArICdhY3RpdmUtYnV0dG9uICcgKyBwcmVmaXggKyAnYWN0aXZlJyxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEljb25DbGFzcyA9IHByZWZpeCArICdvcmlnaW5hbC1pY29uJztcblxuICAgICAgICAgICAgLy8gUmVzZXQgYWxsIGJ1dHRvbnMgYW5kIGRyb3Bkb3duIHN0YXRlXG4gICAgICAgICAgICAkKCcuJyArIHByZWZpeCArICdhY3RpdmUtYnV0dG9uJywgdC4kYnRuUGFuZSkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3Nlcyk7XG4gICAgICAgICAgICAkKCcuJyArIG9yaWdpbmFsSWNvbkNsYXNzLCB0LiRidG5QYW5lKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJ3N2ZyB1c2UnKS5hdHRyKCd4bGluazpocmVmJywgJCh0aGlzKS5kYXRhKG9yaWdpbmFsSWNvbkNsYXNzKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlQnV0dG9uUGFuZVN0YXR1czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHQuby5wcmVmaXgsXG4gICAgICAgICAgICAgICAgYWN0aXZlQ2xhc3NlcyA9IHByZWZpeCArICdhY3RpdmUtYnV0dG9uICcgKyBwcmVmaXggKyAnYWN0aXZlJyxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEljb25DbGFzcyA9IHByZWZpeCArICdvcmlnaW5hbC1pY29uJyxcbiAgICAgICAgICAgICAgICB0YWdzID0gdC5nZXRUYWdzUmVjdXJzaXZlKHQuZG9jLmdldFNlbGVjdGlvbigpLmZvY3VzTm9kZSk7XG5cbiAgICAgICAgICAgIHQuY2xlYXJCdXR0b25QYW5lU3RhdHVzKCk7XG5cbiAgICAgICAgICAgICQuZWFjaCh0YWdzLCBmdW5jdGlvbiAoaSwgdGFnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ0bk5hbWUgPSB0LnRhZ1RvQnV0dG9uW3RhZy50b0xvd2VyQ2FzZSgpXSxcbiAgICAgICAgICAgICAgICAgICAgJGJ0biA9ICQoJy4nICsgcHJlZml4ICsgYnRuTmFtZSArICctYnV0dG9uJywgdC4kYnRuUGFuZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoJGJ0bi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICRidG4uYWRkQ2xhc3MoYWN0aXZlQ2xhc3Nlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRidG4gPSAkKCcuJyArIHByZWZpeCArICdkcm9wZG93biAuJyArIHByZWZpeCArIGJ0bk5hbWUgKyAnLWRyb3Bkb3duLWJ1dHRvbicsIHQuJGJveCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGJ0blN2Z1VzZSA9ICRidG4uZmluZCgnc3ZnIHVzZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duQnRuTmFtZSA9ICRidG4ucGFyZW50KCkuZGF0YShwcmVmaXggKyAnZHJvcGRvd24nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZHJvcGRvd25CdG4gPSAkKCcuJyArIHByZWZpeCArIGRyb3Bkb3duQnRuTmFtZSArICctYnV0dG9uJywgdC4kYm94KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZHJvcGRvd25CdG5TdmdVc2UgPSAkZHJvcGRvd25CdG4uZmluZCgnc3ZnIHVzZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIaWdobGlnaHQgdGhlIGRyb3Bkb3duIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgJGRyb3Bkb3duQnRuLmFkZENsYXNzKGFjdGl2ZUNsYXNzZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTd2l0Y2ggZHJvcGRvd24gaWNvbiB0byB0aGUgYWN0aXZlIHN1Yi1pY29uIG9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuby5jaGFuZ2VBY3RpdmVEcm9wZG93bkljb24gJiYgJGJ0blN2Z1VzZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSBvcmlnaW5hbCBpY29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRyb3Bkb3duQnRuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhvcmlnaW5hbEljb25DbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEob3JpZ2luYWxJY29uQ2xhc3MsICRkcm9wZG93bkJ0blN2Z1VzZS5hdHRyKCd4bGluazpocmVmJykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHV0IHRoZSBhY3RpdmUgc3ViLWJ1dHRvbidzIGljb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZHJvcGRvd25CdG5TdmdVc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3hsaW5rOmhyZWYnLCAkYnRuU3ZnVXNlLmF0dHIoJ3hsaW5rOmhyZWYnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBnZXRUYWdzUmVjdXJzaXZlOiBmdW5jdGlvbiAoZWxlbWVudCwgdGFncykge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICAgICAgdGFncyA9IHRhZ3MgfHwgKGVsZW1lbnQgJiYgZWxlbWVudC50YWdOYW1lID8gW2VsZW1lbnQudGFnTmFtZV0gOiBbXSk7XG5cbiAgICAgICAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YWdzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdGFnID0gZWxlbWVudC50YWdOYW1lO1xuICAgICAgICAgICAgaWYgKHRhZyA9PT0gJ0RJVicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFncztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YWcgPT09ICdQJyAmJiBlbGVtZW50LnN0eWxlLnRleHRBbGlnbiAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICB0YWdzLnB1c2goZWxlbWVudC5zdHlsZS50ZXh0QWxpZ24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkLmVhY2godC50YWdIYW5kbGVycywgZnVuY3Rpb24gKGksIHRhZ0hhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICB0YWdzID0gdGFncy5jb25jYXQodGFnSGFuZGxlcihlbGVtZW50LCB0KSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGFncy5wdXNoKHRhZyk7XG5cbiAgICAgICAgICAgIHJldHVybiB0LmdldFRhZ3NSZWN1cnNpdmUoZWxlbWVudCwgdGFncykuZmlsdGVyKGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFnICE9IG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBQbHVnaW5zXG4gICAgICAgIGluaXRQbHVnaW5zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICB0LmxvYWRlZFBsdWdpbnMgPSBbXTtcbiAgICAgICAgICAgICQuZWFjaCgkLnRydW1ib3d5Zy5wbHVnaW5zLCBmdW5jdGlvbiAobmFtZSwgcGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4uc2hvdWxkSW5pdCB8fCBwbHVnaW4uc2hvdWxkSW5pdCh0KSkge1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uaW5pdCh0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBsdWdpbi50YWdIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LnRhZ0hhbmRsZXJzLnB1c2gocGx1Z2luLnRhZ0hhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHQubG9hZGVkUGx1Z2lucy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGRlc3Ryb3lQbHVnaW5zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgICAgICAkLmVhY2godGhpcy5sb2FkZWRQbHVnaW5zLCBmdW5jdGlvbiAoaSwgcGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBsdWdpbi5kZXN0cm95KSB7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5kZXN0cm95KHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbn0pKG5hdmlnYXRvciwgd2luZG93LCBkb2N1bWVudCwgalF1ZXJ5KTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/trumbowyg/dist/trumbowyg.js\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./resources/js/admin.js");
/******/ 	
/******/ })()
;